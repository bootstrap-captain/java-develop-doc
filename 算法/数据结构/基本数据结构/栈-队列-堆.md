# æ ˆ

- åªèƒ½ä»æ•°æ®ç»“æ„çš„ä¸€ç«¯è¿›è¡Œæ“ä½œï¼Œå…ˆè¿›åå‡º

![image-20231016113311031](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231016113311031.png)

```java
package com.citi.stack;

public interface MyStack {
    boolean push(int val);

    int pop();

    int peek();

    boolean isEmpty();

    boolean isFull();
}
```

## 1. é“¾è¡¨å®ç°

- å•å‘å¸¦å“¨å…µé“¾è¡¨ï¼Œå¤´æ’å¤´å‡º

![image-20231016115640568](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231016115640568.png)

```java
package com.citi.stack;

import java.util.NoSuchElementException;

public class LinkedListStack implements MyStack {
    class Node {
        int val;
        Node next;

        public Node(int val, Node next) {
            this.val = val;
            this.next = next;
        }
    }

    Node sentinel = new Node(-999, null);
    int size;
    int capacity;

    public LinkedListStack(int capacity) {
        this.capacity = capacity;
    }

    @Override
    public boolean push(int val) {
        if (isFull()) {
            return false;
        }
        sentinel.next = new Node(val, sentinel.next);
        size++;
        return true;
    }

    @Override
    public int pop() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        Node removed = sentinel.next;
        sentinel.next = removed.next;
        size--;
        return removed.val;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return sentinel.next.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == capacity;
    }
}
```

## 2. æ•°ç»„å®ç°

![image-20231202101646696](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202101646696.png)

```java
package com.citi.stack;

import java.util.NoSuchElementException;

public class ArrayStack implements MyStack {
    int[] arr;

    int top = 0;

    public ArrayStack(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean push(int val) {
        if (isFull()) {
            return false;
        }
        arr[top] = val;
        top++;
        return true;
    }

    @Override
    public int pop() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        int result = arr[top - 1];
        arr[top - 1] = -999;
        top--;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return arr[top - 1];
    }

    @Override
    public boolean isEmpty() {
        return top == 0;
    }

    @Override
    public boolean isFull() {
        return top == arr.length;
    }
}
```

## 3. æ ˆ-é˜Ÿåˆ—è½¬æ¢

### ğŸ˜[232. ç”¨æ ˆå®ç°é˜Ÿåˆ—](https://leetcode.cn/problems/implement-queue-using-stacks/)

- å‡ºçš„æ—¶å€™ï¼Œå…ˆæŠŠå½“å‰çš„outStackä¸­å‡ºå®Œï¼Œå†å»å€’æ‰‹

![image-20231018120502207](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231018120502207.png)

```java
import java.util.LinkedList;
import java.util.NoSuchElementException;

class MyQueue {

    LinkedList<Integer> inStack = new LinkedList<>();
    LinkedList<Integer> outStack = new LinkedList<>();

    int size = 0;


    public MyQueue() {
    }

    public void push(int x) {
        inStack.push(x);
        size++;
    }

    public int pop() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }

        if (outStack.isEmpty()) {
            while (!inStack.isEmpty()) {
                outStack.push(inStack.pop());
            }
        }
        size--;
        return outStack.pop();
    }

    public int peek() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }

        if (outStack.isEmpty()) {
            while (!inStack.isEmpty()) {
                outStack.push(inStack.pop());
            }
        }
        return outStack.peek();
    }

    public boolean empty() {
        return size == 0;
    }
}
```

### ğŸ˜[225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ](https://leetcode.cn/problems/implement-stack-using-queues/)

![image-20231202135602075](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202135602075.png)

```java
import java.util.LinkedList;
import java.util.NoSuchElementException;

class MyStack {

    LinkedList<Integer> queue = new LinkedList<>();

    public MyStack() {
    }

    public void push(int x) {
        queue.push(x);
        for (int i = 0; i < queue.size() - 1; i++) {
            queue.push(queue.pop());
        }
    }

    public int pop() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return queue.pop();
    }

    public int top() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return queue.peek();
    }

    public boolean empty() {
        return queue.isEmpty();
    }
}
```

## ğŸ˜ [20. æœ‰æ•ˆçš„æ‹¬å·](https://leetcode.cn/problems/valid-parentheses/)

### æ ˆ

- éå†å­—ç¬¦ä¸²ï¼Œå¦‚æœå·¦è¾¹ç¬¦å·ï¼Œåˆ™å…¥æ ˆå¦ä¸€åŠå­—ç¬¦ï¼›
- å¦‚æœå³è¾¹ï¼Œåˆ™å‡ºæ ˆå¹¶æ¯”è¾ƒ

```java
public boolean isValid(String s) {
    LinkedList<Character> stack = new LinkedList<>();
    char[] chs = s.toCharArray();

    if (chs.length % 2 != 0) {
        return false;
    }
    for (char ch : chs) {
        if (ch == '{') {
            stack.push('}');
        } else if (ch == '[') {
            stack.push(']');
        } else if (ch == '(') {
            stack.push(')');
        } else {
            if (stack.isEmpty()) {
                return false;
            }
            if (stack.pop()!=ch){
                return false;
            }
        }
    }
    return stack.isEmpty();
}
```

## é€†æ³¢å…°è¡¨è¾¾å¼

### ğŸ˜¡[150. é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼](https://leetcode.cn/problems/evaluate-reverse-polish-notation/)

- <font color=orange>åç¼€è¡¨è¾¾å¼</font>ï¼šè¿ç®—ç¬¦å·åœ¨æ•°å­—çš„åé¢ï¼Œè¿™æ ·å°±ä¸ç”¨è€ƒè™‘ä¼˜å…ˆçº§é—®é¢˜
- JVMçš„è¿ç®—æŒ‡ä»¤å°±æ˜¯è¿™ä¹ˆç©çš„

#### æ ˆ

- ç¢°è§ç¬¦å·å°±æŠŠå‰é¢ä¸¤ä¸ªæ•°å­—å¼¹å‡ºæ ˆ
- è¿ç®—å®Œæˆåé‡æ–°å…¥æ ˆ

```java
public int evalRPN(String[] tokens) {
      LinkedList<Integer> stack = new LinkedList<>();
      for (String token : tokens) {
          // å¤„ç†å…·ä½“é€»è¾‘
          Integer second;
          Integer first;
          switch (token) {
              case "+":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first + second);
                  break;
              case "-":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first - second);
                  break;
              case "*":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first * second);
                  break;
              case "/":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first / second);
                  break;
              default:
                  stack.push(Integer.valueOf((token)));
          }
      }
      return stack.pop();
  }
```

### ğŸ˜¡ä¸­ç¼€è½¬åç¼€-æ— æ‹¬å·

- ç»™ä¸€ä¸ªä¸­ç¼€è¡¨è¾¾å¼ï¼Œå°†å…¶è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼

![image-20231202132427456](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202132427456.png)

```java
/*ä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€*/
public String convert(String str) {
    LinkedList<Character> stack = new LinkedList<>();
    StringBuffer sb = new StringBuffer();
    char[] chs = str.toCharArray();

    for (char ch : chs) {
        if (priority(ch) == -1) {  // 1. ä¸æ˜¯è¿ç®—ç¬¦ï¼Œåˆ™ç›´æ¥æ‹¼æ¥
            sb.append(ch);
        } else {                   // 2. æ˜¯è¿ç®—ç¬¦
            if (stack.isEmpty()) {
                stack.push(ch);           // 2.1 æ ˆå¦‚æœä¸ºç©ºï¼Œåˆ™ç›´æ¥æ·»åŠ 
            } else {                      // 2.2 æ ˆä¸ç©ºï¼Œåˆ¤æ–­
                if (priority(ch) <= priority(stack.peek())) {
                    while (!stack.isEmpty() && stack.peek() >= priority(ch)) {
                        sb.append(stack.pop());
                    }
                }
                stack.push(ch);
            }
        }
    }
    //3. å¤„ç†å®Œæˆåï¼ŒæŠŠæ ˆé‡Œçš„å…ƒç´ ä¾æ¬¡å‡ºæ ˆæ‹¼æ¥
    while (!stack.isEmpty()) {
        sb.append(stack.pop());
    }
    return sb.toString();
}

private int priority(char ch) {
    switch (ch) {
        case '+':
        case '-':
            return 0;
        case '*':
        case '/':
            return 1;
        default:
            return -1;
    }
}
```

# é˜Ÿåˆ—

## 1. æ™®é€šé˜Ÿåˆ—

- å°¾è¿›æ•°æ®ï¼Œå¤´å‡ºæ•°æ®
- 622é¢˜ç›®

```java
package com.citi.queue;

interface MyQueue {

    /*å°¾æ’*/
    boolean offer(int val);

    /*å¤´å¼¹ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›null*/
    int poll();

    /*è·å–å¤´å…ƒç´ ï¼Œä¸å¼¹å‡ºæ¥ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›null*/
    int peek();

    boolean isEmpty();

    boolean isFull();
}
```

### é“¾è¡¨å®ç°

- å¯ä»¥ä½¿ç”¨å•å‘ç¯å½¢å¸¦å“¨å…µçš„é“¾è¡¨æ¥å®ç°é˜Ÿåˆ—

![image-20231129130253403](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231129130253403.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class LinkedListQueue implements MyQueue {

    class Node {
        int val;
        Node next;

        public Node(int val) {
            this.val = val;
        }

        public Node(int val, Node next) {
            this.val = val;
            this.next = next;
        }
    }

    Node sentinel = new Node(-999);
    Node head; // headä¸ä¼šç§»åŠ¨
    Node tail; // tailç§»åŠ¨
    int size = 0;
    int capacity;

    public LinkedListQueue(int capacity) {
        this.capacity = capacity;
        sentinel.next = sentinel;
        head = sentinel;
        tail = sentinel;
    }

    /*å°¾æ’*/
    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        inserted.next = sentinel;
        tail.next = inserted;
        tail = tail.next;
        size++;
        return true;
    }

    /*åˆ é™¤sentinelåé¢çš„ç¬¬ä¸€ä¸ªå…ƒç´ : è¦è€ƒè™‘åªå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µ*/
    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.next;
        sentinel.next = sentinel.next.next;
        size--;
        // æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œè€ƒè™‘ä¸‹
        if (isEmpty()) {
            tail = sentinel;
        }
        return removed.val;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.next.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        if (size == capacity) {
            return true;
        }
        return false;
    }
}
```

### ç¯å½¢æ•°ç»„

- ç›¸æ¯”æ™®é€šæ•°ç»„ï¼Œèµ·ç‚¹å’Œç»ˆç‚¹æ›´åŠ è‡ªç”±ï¼Œä¸ç”¨è€ƒè™‘æ•°æ®ç§»åŠ¨
- ç¯å½¢æ•°ç»„ï¼Œå°±æ˜¯åœ¨æ•°ç»„é•¿åº¦å›ºå®šçš„æƒ…å†µä¸‹ï¼Œå®šä¹‰ä¸€å®šçš„å¯ç”¨ç´¢å¼•èŒƒå›´ï¼Œé€šè¿‡è¦†ç›–å†™æ¥è¿›è¡Œ
- æ•°ç»„æ€§èƒ½æ›´ä½³
- å¯ä»¥ç”¨ä¸‰ç§ä¸åŒçš„å®ç°æ¥åš
- ä¸‹ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼šhead = (head +1)%arr.lengthï¼Œæ¯æ¬¡è®¡ç®—ç´¢å¼•ï¼Œéƒ½å¿…é¡»é€šè¿‡è¿™ä¸ªå…¬å¼ï¼Œè€Œä¸èƒ½ä½¿ç”¨++æˆ–è€…--

#### ç©ºä½ç½®

- ç©ºä½ç½®æ˜¯ç§»åŠ¨çš„ï¼Œæ˜¯headåé¢çš„ä¸€ä¸ªå…ƒç´ 
- æµªè´¹äº†ä¸€ä¸ªç´¢å¼•ä½ç½®æ¥è¿›è¡Œåˆ¤æ»¡
- ä¸Šä¸€ä¸ªå…ƒç´ ä½ç½® tail = (tail+(arr.length-1))%arr.length, ç”¨æ¥è·å–å°¾éƒ¨å…ƒç´ ï¼Œé˜²æ­¢æ•°ç»„è¶Šç•Œ

![image-20231205211525773](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231205211525773.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayFirstQueue implements MyQueue {

    int[] arr;

    int head = 0;

    int tail = 0;

    public ArrayFirstQueue(int capacity) {
        this.arr = new int[capacity + 1]; // ç©ºä½ç½®è¦ä¿å­˜æ•°æ®
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length; // tailå‘åç§»åŠ¨ä¸€æ¬¡
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head];
        arr[head] = -999; // å¯ä»¥ä¸è¦†ç›–å†™
        head = (head + 1) % arr.length;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head];
    }

    @Override
    public boolean isEmpty() {
        return head == tail;
    }

    /*tail+1=head*/
    @Override
    public boolean isFull() {
        return head == (tail + 1) % arr.length;
    }
}
```

#### æ–°å¢size

- æ–°å¢ä¸€ä¸ªsizeå˜é‡ï¼Œæ¥åˆ¤æ–­é˜Ÿåˆ—æ˜¯ç©ºè¿˜æ˜¯æ»¡

![image-20231130103618498](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231130103618498.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArraySecondQueue implements MyQueue {
    int[] arr;

    int size;

    int head = 0;
    int tail = 0;

    public ArraySecondQueue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length;
        size++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head];
        arr[head] = -999; // å¯ä»¥ä¸è¦†ç›–å†™
        head = (head + 1) % arr.length;
        size--;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }
}
```

#### head/tailè‡ªå¢

- headå’Œtailä¸æ–­è‡ªå¢ï¼Œè‡ªå¢åˆ°æ­£æ— ç©·
- å…·ä½“è®¡ç®—ä¸‹ä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†å»è¿›è¡Œè¿ç®—
- æ²¡æœ‰sizeå±æ€§

##### æ¨¡è¿ç®—

![image-20231014110521963](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231014110521963.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayThirdQueue implements MyQueue {
    int[] arr;
    int head = 0;
    int tail = 0;

    public ArrayThirdQueue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[(tail) % arr.length] = val;
        tail++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head % arr.length];
        arr[head % arr.length] = -999; // å¯ä»¥ä¸è¦†ç›–
        head++;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head % arr.length];
    }

    @Override
    public boolean isEmpty() {
        return tail == head;
    }

    @Override
    public boolean isFull() {
        return tail - head == arr.length;
    }
}
```

##### ä½è¿ç®—

- å‡å¦‚æ•°ç»„çš„headå’Œtailä¸€ç›´å¢åŠ ï¼Œé‚£ä¹ˆå½“è¶…è¿‡intçš„æœ€å¤§å€¼çš„æ—¶å€™ï¼Œè®¡ç®—å‡ºæ¥çš„ç´¢å¼•å°±æ˜¯è´Ÿï¼Œå°±ä¼šæŠ¥é”™
- å½“æ•°ç»„é•¿åº¦æ˜¯2çš„næ¬¡æ–¹çš„æ—¶å€™ï¼Œè®¡ç®—ç´¢å¼•çš„æ—¶å€™ï¼Œæ±‚æ¨¡è¿ç®—å¯ä»¥ç”¨ä½è¿ç®—æ¥ä»£æ›¿

```bash
# æ±‚æ¨¡è¿ç®— vs æŒ‰ä½ä¸
# å‰æï¼šé™¤æ•°æ˜¯ 2 çš„  n  æ¬¡æ–¹

# ç»“æœï¼š head&(arr.length-1)
```

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayFourthQueue implements MyQueue{
    int[] arr;
    int head = 0;
    int tail = 0;

    public ArrayFourthQueue(int capacity) {
        arr = new int[capacity];
    }

    /*è¯¥ç”¨ä½è¿ç®—
    1. å¯ä»¥è§£å†³ç´¢å¼•è¶…è¿‡intèŒƒå›´é—®é¢˜
    2. ä½è¿ç®—æ›´å¿«*/
    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[(tail) & (arr.length - 1)] = val;
        tail++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head & (arr.length - 1)];
        arr[head & (arr.length - 1)] = -999; // å¯ä»¥ä¸è¦†ç›–
        head++;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head & (arr.length - 1)];
    }

    @Override
    public boolean isEmpty() {
        return tail == head;
    }

    /*ä¸ç”¨æ‹…å¿ƒè¶Šç•Œé—®é¢˜*/
    @Override
    public boolean isFull() {
        return tail - head == arr.length;
    }
}
```

## 2. åŒç«¯é˜Ÿåˆ—

- ä¸¤ç«¯éƒ½å¯ä»¥è¿›è¡Œåˆ é™¤ï¼Œæ·»åŠ 
- Deque: Double Ended Queue
- 641é¢˜ç›®

```java
package com.citi.deque;

interface MyDequeue {
    boolean offerFirst(int val);

    boolean offerLast(int val);

    int pollFirst();

    int pollLast();

    int peekFirst();

    int peekLast();

    boolean isEmpty();

    boolean isFull();
}
```

### é“¾è¡¨å®ç°

- åŒå‘ç¯å½¢é“¾è¡¨ï¼Œå¸¦å¤´æŒ‡é’ˆ

![image-20231203111932930](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231203111932930.png)

```java
import java.util.NoSuchElementException;

public class LinkedDequeue implements MyDequeue {

    Node sentinel = new Node(-999);

    int size;
    int capacity;


    public LinkedDequeue(int capacity) {
        this.capacity = capacity;
        sentinel.next = sentinel;
        sentinel.prev = sentinel;
    }


    @Override
    public boolean offerFirst(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        size++;
        // æ’å…¥ç»“ç‚¹ï¼šç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        inserted.prev = sentinel;
        inserted.next = sentinel.next;
        // ç»´æŠ¤å‰å
        sentinel.next.prev = inserted;
        sentinel.next = inserted;
        return true;
    }

    @Override
    public boolean offerLast(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        size++;
        // æ’å…¥ç»“ç‚¹ï¼šç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        inserted.prev = sentinel.prev;
        inserted.next = sentinel;
        // ç»´æŠ¤å‰å
        sentinel.prev.next = inserted;
        sentinel.prev = inserted;
        return true;
    }

    @Override
    public int pollFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.next;
        // åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        sentinel.next = sentinel.next.next;
        sentinel.next.prev = sentinel;
        size--;
        return removed.val;
    }

    @Override
    public int pollLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.prev;
        // åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        sentinel.prev.prev.next = sentinel;
        sentinel.prev = sentinel.prev.prev;
        size--;
        return removed.val;
    }

    @Override
    public int peekFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.next.val;
    }

    @Override
    public int peekLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.prev.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == capacity;
    }
}
```

```java
class Node {
    int val;
    Node prev;
    Node next;

    public Node(int val) {
        this.val = val;
    }

    public Node(Node prev, int val, Node next) {
        this.prev = prev;
        this.val = val;
        this.next = next;
    }
}
```

### ç¯å½¢æ•°ç»„

#### ç©ºä½ç½®

#### æ–°å¢size

![image-20231205225124108](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231205225124108.png)

```java
package com.citi.deque;

import java.util.NoSuchElementException;

public class SecondArrayDequeue implements MyDequeue {

    int[] arr;

    int size;

    int head;

    int tail;

    public SecondArrayDequeue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offerFirst(int val) {
        if (isFull()) {
            return false;
        }
        // ç´¢å¼•å‡ä¸€çš„å¤„ç†
        head = (head + arr.length - 1) % arr.length;
        arr[head] = val;
        size++;
        return true;
    }

    @Override
    public boolean offerLast(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length;
        size++;
        return true;
    }

    @Override
    public int pollFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        int result = arr[head];
        arr[head] = -999;
        head = (head + 1) % arr.length;
        size--;
        return result;
    }

    @Override
    public int pollLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }

        tail = (tail + arr.length - 1) % arr.length; // å‡1
        int result = arr[tail];
        arr[tail] = -999;
        size--;
        return result;
    }

    @Override
    public int peekFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        return arr[(head % arr.length)];
    }

    @Override
    public int peekLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        return arr[(tail + arr.length - 1) % arr.length];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }
}
```

#### head/tailè‡ªå¢

- headå’Œtailä¸æ–­è‡ªå¢ï¼Œè‡ªå¢åˆ°æ­£æ— ç©·
- å…·ä½“è®¡ç®—ä¸‹ä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†å»è¿›è¡Œè¿ç®—
- æ²¡æœ‰sizeå±æ€§

## 3. ä¼˜å…ˆçº§é˜Ÿåˆ—

- æ•°ç»„çš„å¯¹è±¡å¤šäº†ä¸€ä¸ªä¼˜å…ˆçº§çš„å±æ€§
- å…¥é˜Ÿæ˜¯å°¾éƒ¨æ’å…¥
- å‡ºé˜Ÿæ—¶ï¼Œä¼˜å…ˆçº§é«˜çš„å…ˆå‡ºæ¥

```java
public interface PriorityQueue {
    boolean offer(Entry entry);

    Entry poll();

    Entry peek();

    boolean isEmpty();

    boolean isFull();
}
```

```java
class Entry {
    int value;
    int priority;

    public Entry(int value, int priority) {
        this.value = value;
        this.priority = priority;
    }
}
```

### æ— åºæ•°ç»„--size

![image-20231206131751397](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231206131751397.png)

```java
package com.citi.priorityqueue;

import java.util.NoSuchElementException;

public class ArrayPriorityQueue implements PriorityQueue {

    Entry[] arr;
    int size;

    @Override
    public boolean offer(Entry entry) {
        if (isFull()) {
            return false;
        }
        arr[size] = entry;
        size++;
        return false;
    }

    @Override
    public Entry poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int targetIndex = selectMaxPriorityIndex();
        Entry removedEntry = arr[targetIndex];
        remove(targetIndex);
        return removedEntry;
    }

    @Override
    public Entry peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int targetIndex = selectMaxPriorityIndex();
        return arr[targetIndex];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }

    /*å¯»æ‰¾ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ */
    private int selectMaxPriorityIndex() {
        int maxIndex = -1;
        int priority = Integer.MIN_VALUE;
        for (int i = 0; i < size; i++) {
            Entry entry = arr[i];
            if (entry.priority > priority) {
                maxIndex = i;
            }
        }
        return maxIndex;
    }

    /*åˆ é™¤å…ƒç´ */
    private void remove(int index) {
        if (index == size - 1) { // é˜Ÿåˆ—æœ€åä¸€ä¸ªå…ƒç´ 
            arr[index] = null;
        } else { // å¤åˆ¶æ‹·è´
            System.arraycopy(arr, index + 1, arr, index, size - 1 + index);
            arr[size - 1] = null;
        }
        size--;
    }
}
```

### æœ‰åºæ•°ç»„å®ç°

- æ’å…¥æ—¶å€™è¿›è¡Œæ’å…¥æ’åºï¼Œå¼¹å‡ºæ—¶ï¼Œåªéœ€è¦å¼¹å‡ºæ•°å°¾éƒ¨çš„å…ƒç´ 

![image-20231022103506620](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231022103506620.png)

```java
class SortedArrayPriorityQueue {
    private Entry[] arr;

    private int capacity;
    private int size;

    public SortedArrayPriorityQueue(int capacity) {
        this.capacity = capacity;
        arr = new Entry[capacity];
    }

    public boolean offer(Entry entry) {
        if (isFull()) {
            return false;
        }
        insert(entry);
        return true;
    }

    /*æ’å…¥æ’åº*/
    private void insert(Entry entry) {
        int p = size - 1;
        while (p > 0 && arr[p].priority > entry.priority) {
            arr[p + 1] = arr[p];
            p--;
        }
        arr[p + 1] = entry;
    }


    public Entry poll() {
        if (isEmpty()) {
            return null;
        }
        Entry entry = arr[size - 1];
        arr[size - 1] = null;
        return entry;
    }

    public Entry peek() {
        if (isEmpty()) {
            return null;
        }
        return arr[size - 1];
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public boolean isFull() {
        return size == capacity;
    }
}
```

### å †å®ç°

- åŸºäºæ•°ç»„å½¢å¼çš„å †å®ç°

# å † - ä¼˜å…ˆé˜Ÿåˆ—

- å †æ˜¯ä¸€ç§ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„çš„æ–¹å¼å®ç°

## 1. å¤§é¡¶å †/å°é¡¶å †

- å°é¡¶å †å’Œå¤§é¡¶å †åŸºæœ¬é€»è¾‘ç±»ä¼¼
- ä¸‹é¢ä»¥<font color=orange>å¤§é¡¶å †</font>ä½œä¸ºç¤ºä¾‹

```bash
# å¤§é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹éƒ½å°äºå…¶çˆ¶èŠ‚ç‚¹
# å°é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹éƒ½å¤§ä¸å…¶çˆ¶èŠ‚ç‚¹
- å·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹å…³ç³»ä¸å®š

# ç´¢å¼•åŸåˆ™ï¼šç´¢å¼•0å¼€å§‹å­˜å‚¨ï¼Œiè¡¨ç¤ºç´¢å¼•
- èŠ‚ç‚¹içš„çˆ¶èŠ‚ç‚¹ï¼š       floor((i-1)/2)      å½“iå¤§äº0æ—¶
- èŠ‚ç‚¹içš„å·¦å­èŠ‚ç‚¹ä¸ºï¼š    2i+1                ç»“æœä¸èƒ½å¤§äºsize
- èŠ‚ç‚¹içš„å³å­èŠ‚ç‚¹ä¸ºï¼š    2i+2                ç»“æœä¸èƒ½å¤§äºsize
```

![image-20231023190718489](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231023190718489.png)

```java
package com.citi.heap;

public interface MaxHeap {
    /*å¤´å°¾äº¤æ¢ï¼Œå¹¶ä¸‹æ½œ*/
    int poll();

    void down(int parent);

    /*å°¾éƒ¨æ·»åŠ ï¼šå¹¶ä¸Šæµ®*/
    boolean offer(int data);

    void up(int child);

    boolean isFull();

    boolean isEmpty();
  
    int size();
}
```

### 1.1 offer

```bash
# offerï¼š æ–°å…ƒç´ ï¼ŒåŠ å…¥åˆ°æ•°ç»„æœ«å°¾(sizeå±æ€§)

# upï¼šä¸æ–­æ¯”è¾ƒæ–°åŠ å…ƒç´ ä¸å…¶çˆ¶èŠ‚ç‚¹çš„å€¼
- çˆ¶èŠ‚ç‚¹æ›´å°ï¼Œåˆ™äº¤æ¢çˆ¶å­èŠ‚ç‚¹ï¼Œç»§ç»­å‘ä¸Šæ‰¾parent
- ç›´åˆ°çˆ¶èŠ‚ç‚¹å€¼æ›´å¤§
```

![image-20231208105006994](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231208105006994.png)

### 1.2 poll

```bash
# pollï¼š åˆ é™¤å †é¡¶å¤„çš„å…ƒç´ 
- 1. å †é¡¶å…ƒç´  å’Œæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢
- 2. åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ 
- 3. å¯¹å †é¡¶å…ƒç´ è¿›è¡Œä¸‹æ½œ

# ä¸‹æ½œï¼š æ¯”å·¦å³å­©å­æœ€å¤§çš„å°
- æ¯”è¾ƒå½“å‰èŠ‚ç‚¹çš„å€¼å’Œå·¦å³å­©å­çš„å€¼
- å¦‚æœå½“å‰èŠ‚ç‚¹çš„å€¼æ¯”å·¦å³å­©å­æœ€å¤§çš„å°ï¼Œåˆ™äº¤æ¢
```

### 1.3 heapify

- å¯¹ä¸€ä¸ªéšæœºæ•°ç»„è¿›è¡Œå †åŒ–

```bash
# å¯¹ç°æœ‰æ•°ç»„è¿›è¡Œé‡æ’
- æ‰¾åˆ°æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹
- ä»åå‘å‰ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œä¸‹æ½œï¼ˆæ¯”è¾ƒå·¦å³å€¼ï¼‰

# éå¶å­èŠ‚ç‚¹
- æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå·¦å­©å­æˆ–è€…å³å­©å­
- æœ€åä¸€ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹
```

![image-20231023152506251](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231023152506251.png)

```java
package com.citi.stack;

public class MaxHeap {
    int[] arr;
    int size;

    public MaxHeap(int[] arr) {
        this.arr = arr;
        this.size = arr.length;
        heapfiy();
    }

    private void heapfiy() {
        // æœ€åä¸€ä¸ªéå¶å­ç»“ç‚¹
        int nonLeafIndex = (size / 2) - 1;
        for (int i = nonLeafIndex; i >= 0; i--) {
            downRecur(i);
        }
    }

    /*down-é€’å½’å®ç°*/
    private void downRecur(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;
        int maxIndex = parentIndex;
        // å¤§é¡¶å †å’Œå°é¡¶å †çš„å®ç°ï¼šåªéœ€è¦æ”¹å˜ç¬¦å·å³å¯
        if (leftChildIndex < size && arr[leftChildIndex] > arr[maxIndex]) {
            maxIndex = leftChildIndex;
        }

        if (rightChildIndex < size && arr[rightChildIndex] > arr[maxIndex]) {
            maxIndex = rightChildIndex;
        }

        // é€’å½’ç»“æŸæ¡ä»¶
        if (parentIndex != maxIndex) {
            swap(parentIndex, maxIndex);
            parentIndex = maxIndex;
            downRecur(parentIndex);
        }
    }

    /*down-è¿­ä»£å®ç°*/
    private void downIterator(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;
        while (true) {
            int maxIndex = parentIndex;
            if (leftChildIndex < size && arr[leftChildIndex] > arr[maxIndex]) {
                maxIndex = leftChildIndex;
            }

            if (rightChildIndex < size && arr[rightChildIndex] > arr[maxIndex]) {
                maxIndex = rightChildIndex;
            }

            if (maxIndex == parentIndex) { // ç»ˆæ­¢
                break;
            }
            swap(parentIndex, maxIndex);
            parentIndex = maxIndex;
            leftChildIndex = parentIndex * 2 + 1;
            rightChildIndex = parentIndex * 2 + 2;
        }
    }

    private void swap(int i, int j) {
        int temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
}
```

## 2. æ•°ç»„å®ç°

- ä¸‹æ½œæ“ä½œï¼Œå¯ä»¥é€šè¿‡è¿­ä»£å’Œé€’å½’ä¸¤ç§å®ç°

```java
abstract class AbstractHeap {
    int[] arr;
    int size;

    public abstract boolean offer(int val);

    public abstract int poll();

    public abstract int peek();

    public boolean isFull() {
        return size == arr.length;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public int size() {
        return size;
    }

    protected void swap(int i, int j) {
        int temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
}
```

### 2.1 MaxHeap

```java
class MaxHeap extends AbstractHeap {

    public MaxHeap(int capacity) {
        this.arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[size] = val;
        upIter(size);
        size++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        int result = arr[0];
        swap(0, size - 1);
        size--;
        downIter(0);
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return arr[0];
    }

    /*ä¸Šæµ®é€’å½’å®ç°*/
    private void upRecur(int childIndex) {
        int parentIndex = (childIndex - 1) / 2;
        if (arr[childIndex] > arr[parentIndex]) {
            swap(childIndex, parentIndex);
            childIndex = parentIndex;
            upRecur(childIndex);
        }
    }

    /*ä¸Šæµ®è¿­ä»£å®ç°*/
    private void upIter(int childIndex) {
        // parentIndexæœ€ç»ˆå¯èƒ½å’ŒchildIndexéƒ½èµ°åˆ°0å¹¶ä¸”ç›¸ç­‰
        int parentIndex = (childIndex - 1) / 2;
        while (arr[childIndex] > arr[parentIndex]) {
            swap(parentIndex, childIndex);
            childIndex = parentIndex;
            parentIndex = (childIndex - 1) / 2;
        }
    }

    /*ä¸‹æ½œé€’å½’å®ç°*/
    private void downRecur(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;
        int maxIndex = parentIndex;

        if (leftChildIndex < size && arr[leftChildIndex] > arr[maxIndex]) {
            maxIndex = leftChildIndex;
        }
        if (rightChildIndex < size && arr[rightChildIndex] > arr[maxIndex]) {
            maxIndex = rightChildIndex;
        }

        /*é€’å½’æ¡ä»¶ï¼šåæ–¹å‘*/
        if (maxIndex != parentIndex) {
            swap(parentIndex, maxIndex);
            parentIndex = maxIndex;
            downRecur(parentIndex);
        }
    }

    /*ä¸‹æ½œè¿­ä»£å®ç°*/
    private void downIter(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;

        while (true) {
            int maxIndex = parentIndex;
            if (leftChildIndex < size && arr[leftChildIndex] > arr[maxIndex]) {
                maxIndex = leftChildIndex;
            }
            if (rightChildIndex < size && arr[rightChildIndex] > arr[maxIndex]) {
                maxIndex = rightChildIndex;
            }

            if (maxIndex == parentIndex) {
                break;
            }

            swap(parentIndex, maxIndex);
            parentIndex = maxIndex;
            leftChildIndex = parentIndex * 2 + 1;
            rightChildIndex = parentIndex * 2 + 2;
        }
    }
}
```

### 2.2 MinHeap

- é€»è¾‘åŸºæœ¬ç›¸åŒ

```java
class MinHeap extends AbstractHeap {
    public MinHeap(int capacity) {
        this.arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[size] = val;
        upIter(size);
        size++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        int result = arr[0];
        swap(0, size - 1);
        size--;
        downIter(0);
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return arr[0];
    }

    /*ä¸Šæµ®é€’å½’å®ç°*/
    private void upRecur(int childIndex) {
        int parentIndex = (childIndex - 1) / 2;
        if (arr[childIndex] < arr[parentIndex]) {
            swap(childIndex, parentIndex);
            childIndex = parentIndex;
            upRecur(childIndex);
        }
    }

    /*ä¸Šæµ®è¿­ä»£å®ç°*/
    private void upIter(int childIndex) {
        // parentIndexæœ€ç»ˆå¯èƒ½å’ŒchildIndexéƒ½èµ°åˆ°0å¹¶ä¸”ç›¸ç­‰
        int parentIndex = (childIndex - 1) / 2;
        while (arr[childIndex] < arr[parentIndex]) {
            swap(parentIndex, childIndex);
            childIndex = parentIndex;
            parentIndex = (childIndex - 1) / 2;
        }
    }

    /*ä¸‹æ½œé€’å½’å®ç°*/
    private void downRecur(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;
        int minIndex = parentIndex;

        if (leftChildIndex < size && arr[leftChildIndex] < arr[minIndex]) {
            minIndex = leftChildIndex;
        }
        if (rightChildIndex < size && arr[rightChildIndex] < arr[minIndex]) {
            minIndex = rightChildIndex;
        }

        if (minIndex != parentIndex) {
            swap(parentIndex, minIndex);
            parentIndex = minIndex;
            downRecur(parentIndex);
        }
    }

    /*ä¸‹æ½œè¿­ä»£å®ç°*/
    private void downIter(int parentIndex) {
        int leftChildIndex = parentIndex * 2 + 1;
        int rightChildIndex = parentIndex * 2 + 2;

        while (true) {
            int minIndex = parentIndex;
            if (leftChildIndex < size && arr[leftChildIndex] < arr[minIndex]) {
                minIndex = leftChildIndex;
            }
            if (rightChildIndex < size && arr[rightChildIndex] < arr[minIndex]) {
                minIndex = rightChildIndex;
            }

            if (minIndex == parentIndex) {
                break;
            }

            swap(parentIndex, minIndex);
            parentIndex = minIndex;
            leftChildIndex = parentIndex * 2 + 1;
            rightChildIndex = parentIndex * 2 + 2;
        }
    }
}
```



```java
class ErickHeap {
    int[] arr;
    boolean isMinHeap;

    int size;

    /*é»˜è®¤æ„å»ºå°é¡¶å †*/
    public ErickHeap(int capacity, boolean isMinHeap) {
        this.isMinHeap = isMinHeap;
        arr = new int[capacity];
    }

    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[size] = val;
        up(size);
        size++;
        return true;
    }

    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        int result = arr[0];
        swap(0, size - 1);
        down(); // downçš„æ—¶å€™æ³¨æ„ï¼šsizeå½“å‰è¿˜æ²¡å‡
        size--;
        return result;
    }

    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return arr[0];
    }

    public boolean isFull() {
        return size == arr.length;
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public int size() {
        return size;
    }

    /*å †åº•å…ƒç´ ä¸Šæµ®*/
    private void up(int childIndex) {
        int parentIndex = (childIndex - 1) / 2; // parentIndexå¯èƒ½å’ŒchildIndexéƒ½å˜ä¸º0
        if (isMinHeap) {
            while (arr[childIndex] < arr[parentIndex]) {
                swap(parentIndex, childIndex);
                childIndex = parentIndex;
                parentIndex = (childIndex - 1) / 2;
            }
        } else {
            while (arr[childIndex] > arr[parentIndex]) {
                swap(parentIndex, childIndex);
                childIndex = parentIndex;
                parentIndex = (childIndex - 1) / 2;
            }
        }
    }

    /*å †é¡¶å…ƒç´ ä¸‹æ½œ*/
    private void down() {
        int parentIndex = 0;
        int leftIndex = parentIndex * 2 + 1;
        int rightIndex = parentIndex * 2 + 2;
        if (isMinHeap) {
            while (true) {
                int minIndex = parentIndex;
                if (leftIndex < size - 1 && arr[leftIndex] < arr[minIndex]) {
                    minIndex = leftIndex;
                }
                if (rightIndex < size - 1 && arr[rightIndex] < arr[minIndex]) {
                    minIndex = rightIndex;
                }
                if (minIndex == parentIndex) {
                    break;
                }
                swap(parentIndex, minIndex);
                parentIndex = minIndex;
                leftIndex = parentIndex * 2 + 1;
                rightIndex = parentIndex * 2 + 2;
            }
        } else {
            while (true) {
                int maxIndex = parentIndex;
                if (leftIndex < size-1 && arr[leftIndex] > arr[maxIndex]) {
                    maxIndex = leftIndex;
                }
                if (rightIndex < size-1 && arr[rightIndex] > arr[maxIndex]) {
                    maxIndex = rightIndex;
                }
                if (maxIndex == parentIndex) {
                    break;
                }
                swap(parentIndex, maxIndex);
                parentIndex = maxIndex;
                leftIndex = parentIndex * 2 + 1;
                rightIndex = parentIndex * 2 + 2;
            }
        }
    }

    private void swap(int i, int j) {
        int temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
}
```

## 3. JDK-PriorityQueue

```java
PriorityQueue<Integer> max = new PriorityQueue<>((a, b) -> (b - a));      // å¤§é¡¶å †
PriorityQueue<Integer> min = new PriorityQueue<>((a, b) -> (a - b));      // å°é¡¶å †

PriorityQueue<ListNode> minHeap = new PriorityQueue<ListNode>((a, b) -> a.val - b.val); // å¤§é¡¶å †
PriorityQueue<ListNode> minHeap = new PriorityQueue<ListNode>((a, b) -> a.val - b.val); // å°é¡¶å †
```

## 4. LeetCode

- TOP-Ké—®é¢˜ï¼Œç›´æ¥å…ˆæƒ³å°é¡¶å †

### ğŸ˜¡ [347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ ](https://leetcode.cn/problems/top-k-frequent-elements/)

#### Hash + å°é¡¶å †

- éå†æ•´ä¸ªæ•°ç»„ï¼Œæ•°å­—ä½œä¸ºkeyï¼Œé¢‘æ¬¡ä½œä¸ºvalueï¼Œå‡å¦‚åˆ°hashä¸­
- ç„¶åç”¨å°é¡¶å †æ¥å¤„ç†

```java
public int[] topKFrequent(int[] nums, int k) {
      Map<Integer, Integer> hash = new HashMap<>();
      for (int i = 0; i < nums.length; i++) {
          if (hash.containsKey(nums[i])) {
              hash.put(nums[i], hash.get(nums[i]) + 1);
          } else {
              hash.put(nums[i], 1);
          }
      }

      PriorityQueue<Map.Entry<Integer, Integer>> minHeap = 
              new PriorityQueue<>(k, (a, b) -> (a.getValue() - b.getValue()));

      for (Map.Entry<Integer, Integer> entry : hash.entrySet()) {
          if (minHeap.size() < k) {
              minHeap.offer(entry);
          } else {
              if (minHeap.peek().getValue() < entry.getValue()) {
                  minHeap.poll();
                  minHeap.offer(entry);
              }
          }
      }

      int[] arr = new int[k];
      for (int i = 0; i < arr.length; i++) {
          arr[i] = minHeap.poll().getKey();
      }

      return arr;
  }
```





### ğŸ˜[703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ ](https://leetcode.cn/problems/kth-largest-element-in-a-stream/)

#### å°é¡¶å †

- å°é¡¶å †(å †åº•å…ƒç´ å°±æ˜¯ç¬¬kå¤§çš„)

```bash
- 1.æ„å»ºå¤§å°ä¸ºkçš„å°é¡¶å †
- 2.å †æ»¡åï¼Œæ–°å…ƒç´ å¦‚æœæ¯”å †é¡¶å°ï¼Œåˆ™å¿½ç•¥ï¼Œå¦åˆ™å¼¹å‡ºå †é¡¶ï¼Œå¹¶æ·»åŠ æ–°å…ƒç´ 
```

```java
/*å°é¡¶å †*/
class KthLargest {

    private PriorityQueue<Integer> minHeap;

    private int capacity;

    /*æŠŠå…ƒç´ é€šè¿‡addæ–¹æ³•æ·»åŠ è¿›å»å³å¯*/
    public KthLargest(int k, int[] nums) {
        this.capacity = k;
        minHeap = new PriorityQueue<>(k);
        for (int num : nums) {
            add(num);
        }
    }

    /*addæ—¶ï¼Œå°é¡¶å †ä¸ä¸€å®šæ˜¯æ»¡çš„å“¦*/
    public int add(int val) {
        /*å †æ»¡å¹¶ä¸”æ–°å…ƒç´ æ¯”å †é¡¶å…ƒç´ å¤§*/
        if (minHeap.size() == capacity) {
            if (val > minHeap.peek()) {
                minHeap.poll();
                minHeap.offer(val);
            }
        } else {
            minHeap.offer(val);
        }
        return minHeap.peek();
    }
}
```

### ğŸ˜¡[215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ](https://leetcode.cn/problems/kth-largest-element-in-an-array/)

#### å°é¡¶å †

```bash
- 1. å°†æ•°ç»„å…ƒç´ ä¾æ¬¡æ”¾å…¥å †ä¸­ï¼Œå †æ»¡å
    - 1.1 å¦‚æœæ–°å…ƒç´ æ¯”å †é¡¶å¤§ï¼Œåˆ™offer
- 2. è¿”å›å †é¡¶å…ƒç´  
```

```java
class Solution {
    public int findKthLargest(int[] nums, int k) {
        /*å°é¡¶å †*/
        PriorityQueue<Integer> minHeap = new PriorityQueue<>(3);
        /*offerè¿›å»kä¸ªå…ƒç´ */
        for (int i = 0; i < k; i++) {
            minHeap.offer(nums[i]);
        }

        for (int i = k; i < nums.length; i++) {
            if (nums[i] > minHeap.peek()) {
                minHeap.poll();
                minHeap.offer(nums[i]);
            }
        }
        return minHeap.peek();
    }
}
```

### ğŸ˜¡[451. æ ¹æ®å­—ç¬¦å‡ºç°é¢‘ç‡æ’åº](https://leetcode.cn/problems/sort-characters-by-frequency/)

#### Hash + å¤§é¡¶å †

```java
public String frequencySort(String s) {
      char[] chs = s.toCharArray();
      Map<Character, Integer> hash = new HashMap<>();
      for (int i = 0; i < chs.length; i++) {
          if (hash.containsKey(chs[i])) {
              hash.put(chs[i], hash.get(chs[i]) + 1);
          } else {
              hash.put(chs[i], 1);
          }
      }

      PriorityQueue<Map.Entry<Character, Integer>> maxHep =
              new PriorityQueue<>((a, b) -> (b.getValue() - a.getValue()));

      for (Map.Entry<Character, Integer> entry : hash.entrySet()) {
          maxHep.offer(entry);
      }

      StringBuilder sb = new StringBuilder();
      while (maxHep.size() != 0) {
          Map.Entry<Character, Integer> poll = maxHep.poll();
          Character ch = poll.getKey();
          for (int i = 0; i < poll.getValue(); i++) {
              sb.append(ch);
          }
      }
      return sb.toString();
  }
```



### *ï¸âƒ£[295. æ•°æ®æµçš„ä¸­ä½æ•°](https://leetcode.cn/problems/find-median-from-data-stream/)

#### å°é¡¶å † +å¤§é¡¶å †

```bash
# æ€è·¯ï¼šæ„å»ºä¸€ä¸ªå¤§é¡¶å †ï¼Œä¸€ä¸ªå°é¡¶å †ï¼Œç¡®ä¿å¤§é¡¶å †çš„å †é¡¶å…ƒç´ å°äºå°é¡¶å †çš„å †é¡¶å…ƒç´ 
      -- å¤§é¡¶å †æ•°æ®ï¼šä¸­ä½æ•°çš„å‰åŠéƒ¨åˆ†
      -- å°é¡¶å †æ•°æ®ï¼šä¸­ä½æ•°çš„ååŠéƒ¨åˆ†
# add
- ä¸¤è¾¹ä¸ªæ•°ä¸€æ ·æ—¶ï¼Œå·¦è¾¹ä¸ªæ•°åŠ ä¸€
- ä¸¤è¾¹ä¸ªæ•°ä¸ä¸€æ ·æ—¶ï¼Œå³è¾¹åŠ ä¸€

# addè§„åˆ™
- å·¦æ·»åŠ æ—¶ï¼ŒæŠŠæ–°å…ƒç´ æ·»åŠ åœ¨å³ï¼Œå¼¹å‡ºå³è¾¹å †é¡¶å…ƒç´ åŠ å…¥å·¦è¾¹
- å³è¾¹é€»è¾‘ç±»ä¼¼
```

![image-20231029104600488](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231029104600488.png)

```java
import java.util.PriorityQueue;

class MedianFinder {

    private PriorityQueue<Integer> leftMax = new PriorityQueue<>((a, b) -> (b - a));
    private PriorityQueue<Integer> rightMin = new PriorityQueue<>((a, b) -> (a - b));

    public MedianFinder() {
    }

    public void addNum(int num) {
        if (leftMax.size() == rightMin.size()) { // å¾€å·¦è¾¹å¤§é¡¶å †ä¸­æ·»åŠ æ•°æ®
            rightMin.offer(num);
            leftMax.offer(rightMin.poll());
        } else {   // å¾€å³è¾¹å¤§é¡¶å †ä¸­æ·»åŠ æ•°æ®
            leftMax.offer(num);
            rightMin.offer(leftMax.poll());
        }
    }

    public double findMedian() {
        if (leftMax.size() == rightMin.size()) {
            return (double) (leftMax.peek() + rightMin.peek()) / 2;
        } else {
            return leftMax.peek();
        }
    }
}
```

### *ï¸âƒ£ [23. åˆå¹¶ K ä¸ªå‡åºé“¾è¡¨](https://leetcode.cn/problems/merge-k-sorted-lists/)

#### å°é¡¶å †

- ä¸ç”¨æŒ‡å®šé˜Ÿåˆ—é•¿åº¦

```java
public ListNode mergeKLists(ListNode[] lists) {
  ListNode sentinel = new ListNode(-999, null);
  // è®°å½•æ–°é“¾è¡¨çš„å°¾å·´
  ListNode p = sentinel;
  PriorityQueue<ListNode> minHeap = new PriorityQueue<ListNode>((a, b) -> a.val - b.val);
  // ç¬¬ä¸€æ¬¡æ”¾å…¥
  for (ListNode node : lists) {
      if (node != null) {
          minHeap.offer(node);
      }
  }

  // å½“å°é¡¶å †æœ‰å…ƒç´ æ—¶
  while (!minHeap.isEmpty()) {
      ListNode poll = minHeap.poll();
      if (poll.next != null) { // é€€å‡ºæ¥çš„å…ƒç´ æœ‰åç»§ï¼Œåç»§å…¥é˜Ÿ
          minHeap.offer((poll.next));
      }
      // å°¾æ’ï¼Œå¹¶ç§»åŠ¨ç»“æœçš„å°¾æŒ‡é’ˆ
      p.next = poll;
      poll.next = null;
      p = poll;
  }
  return sentinel.next;
}
```



# JDK-æ ˆ-é˜Ÿåˆ—(æ™®é€š,åŒç«¯)

## 1. LinkedList

- åº•å±‚æ˜¯ç”¨é“¾è¡¨å®ç°
- æ ˆï¼Œæ™®é€šé˜Ÿåˆ—ï¼ŒåŒç«¯é˜Ÿåˆ—

## 2. ArrayDeque

- åº•å±‚ç”¨æ•°ç»„å®ç°
- æ ˆï¼Œæ™®é€šé˜Ÿåˆ—ï¼ŒåŒç«¯é˜Ÿåˆ—



