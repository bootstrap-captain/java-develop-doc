# åŸºæœ¬æ–¹æ³•

- èŠ‚ç‚¹valueä¸é‡å¤
- æ‰€æœ‰èŠ‚ç‚¹ï¼Œvalueæ¯”å·¦å­æ ‘çš„valueå¤§ï¼ŒåŒæ—¶ä¹Ÿæ¯”å³å­æ ‘çš„valueå°

```java
package com.citi.tree;

public class TreeNode {
    int val;
    TreeNode left;
    TreeNode right;

    public TreeNode(int val) {
        this.val = val;
    }

    public TreeNode(int val, TreeNode left, TreeNode right) {
        this.val = val;
        this.left = left;
        this.right = right;
    }
}
```

```java
    TreeNode root = new TreeNode(8, new TreeNode(6,
            new TreeNode(4, new TreeNode(2), new TreeNode(5)), null),
            new TreeNode(15, new TreeNode(13, new TreeNode(10), new TreeNode(14))
                    , new TreeNode(20, new TreeNode(18), null)));
```

![image-20231225154313795](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231225154313795.png)

## 1. æ ¹æ®keyæŸ¥æ‰¾

### é€’å½’

```java
public TreeNode getByValueRecur(TreeNode root, int value) {
    if (root == null) {
        return null;
    }

    if (root.val < value) {
        return getByValueIterator(root.right, value);
    } else if (root.val > value) {
        return getByValueRecur(root.left, value);
    }else{
        return root;
    }
}
```

### è¿­ä»£

```java
public TreeNode getByValueIterator(TreeNode root, int value) {
    TreeNode cur = root;
    while (cur != null) {
        if (cur.val < value) {
            cur = cur.right;
        } else if (cur.val > value) {
            cur = cur.left;
        } else {
            return cur;
        }
    }
    return null;
}
```

## 2. æœ€å°/å¤§key

- æœ€å°æ˜¯æ‰¾å·¦è¾¹ï¼Œæœ€å¤§æ˜¯æ‰¾å³è¾¹

### é€’å½’

```java
public TreeNode getMinRecur(TreeNode root) {
    if (root == null) {
        return null;
    }

    if (root.left == null) {
        return root;
    }

    TreeNode min = getMinRecur(root.left);
    return min;
}

public TreeNode getMaxRecur(TreeNode root) {
    if (root == null) {
        return null;
    }

    if (root.right == null) {
        return root;
    }
    TreeNode max = getMaxRecur(root.right);
    return max;
}
```

### è¿­ä»£

```java
public TreeNode getMinIterator(TreeNode root) {
    if (root == null) {
        return null;
    }

    TreeNode cur = root;
    while (cur.left != null) {
        cur = cur.left;
    }
    return cur;
}

public TreeNode getMaxIterator(TreeNode root) {
    if (root == null) {
        return null;
    }

    TreeNode cur = root;
    while (cur.right != null) {
        cur = cur.right;
    }
    return cur;
}
```

## 3. put

- keyå¦‚æœå­˜åœ¨ï¼Œåˆ™æ›´æ–°ï¼Œkeyä¸å­˜åœ¨ï¼Œæ–°å¢å·¦æˆ–å³èŠ‚ç‚¹

```java
public boolean put(TreeNode root, int value) {
    if (root == null) {
        root = new TreeNode(value); // ç©ºæ ‘
        return true;
    }

    TreeNode cur = root;
    TreeNode prev = null;
    while (cur != null) {
        if (cur.val > value) {
            prev = cur;
            cur = cur.left;
        } else if (cur.val < value) {
            prev = cur;
            cur = cur.right;
        } else {
            return false; // åŸæ¥å·²ç»å­˜åœ¨ï¼Œæ›¿æ¢å³å¯
        }
    }

    /*å·¦æˆ–å³*/
    TreeNode inserted = new TreeNode(value);
    if (value < prev.val) {
        prev.left = inserted;
    } else {
        prev.right = inserted;
    }
    return true;
}
```

## 4. å‰ä»»

- å³ä¸Šä¸€ä¸ªèŠ‚ç‚¹
- èŠ‚ç‚¹ pçš„å‰ä»»æ˜¯å€¼æ¯”p.valå°çš„èŠ‚ç‚¹ä¸­é”®å€¼æœ€å¤§çš„èŠ‚ç‚¹, å¦‚5çš„å‰ä»»æ˜¯4

![image-20231225154313795](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231225154313795.png)

### ä¸­åº + è¿­ä»£

```java
public TreeNode beforeNode(TreeNode root, TreeNode p) {
    LinkedList<TreeNode> paths = new LinkedList<>();
    TreeNode cur = root;
    TreeNode lastPop = null;

    while (cur != null || !paths.isEmpty()) {
        if (cur != null) {
            paths.push(cur);
            cur = cur.left;
        } else {
            TreeNode pop = paths.pop();
            if (pop.val == p.val) {
                return lastPop;
            }

            lastPop = pop;
            if (pop.right != null) {
                cur = pop.right;
            }
        }
    }

    return lastPop;
}
```

### æœç´¢æ ‘

```bash
# å‰ä»»
- å…ˆæ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹
- ç›®æ ‡èŠ‚ç‚¹æœ‰å·¦å­æ ‘ï¼Œå‰ä»»å°±æ˜¯å·¦å­æ ‘çš„æœ€å¤§å€¼ï¼š                 6 çš„å‰ä»»æ˜¯ 5
- ç›®æ ‡èŠ‚ç‚¹æ²¡æœ‰å·¦å­æ ‘ï¼Œå‰ä»»å°±æ˜¯ç¦»å®ƒæœ€è¿‘çš„ï¼Œä»å·¦è¾¹æ¥çš„ç¥–å…ˆï¼š      10 çš„å‰ä»»æ˜¯ 8
```

```java
public TreeNode beforeNode(TreeNode root, TreeNode p) {
    TreeNode cur = root;
    TreeNode leftAncestor = null;

    while (cur != null) {
        if (cur.val < p.val) {
            leftAncestor = cur;
            cur = cur.right;
        } else if (cur.val > p.val) {
            cur = cur.left;
        } else {
            break; // æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œé€€å‡º
        }
    }

    if (cur.left != null) { // æ‰¾å·¦å­æ ‘çš„æœ€å¤§å€¼
        TreeNode node = cur.left;
        while (node.right != null) {
            node = node.right;
        }
        return node;
    } else {
        return leftAncestor;
    }
}
```

## 5.ğŸ˜¡[åç»§](https://leetcode.cn/problems/P5rCT8/)

- å³ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
- èŠ‚ç‚¹ pçš„åç»§æ˜¯å€¼æ¯”p.valå¤§çš„èŠ‚ç‚¹ä¸­é”®å€¼æœ€å°çš„èŠ‚ç‚¹, å¦‚5çš„åç»§æ˜¯6
- rootèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œpæ˜¯rootä¸­çš„ä¸€ä¸ª

![image-20231225154313795](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231225154313795.png)

### ä¸­åº-è¿­ä»£

- æ•ˆç‡è¾ƒä½ï¼Œæ²¡æœ‰å……åˆ†åˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„ç‰¹æ€§

```java
public TreeNode inorderSuccessor(TreeNode root, TreeNode p) {
    LinkedList<TreeNode> paths = new LinkedList<>();
    TreeNode cur = root;

    boolean isTargetFound = false;

    while (cur != null || !paths.isEmpty()) {
        if (cur != null) {
            paths.push(cur);
            cur = cur.left;
        } else {
            TreeNode pop = paths.pop();
            if (isTargetFound) { // å½“å‰popçš„å°±æ˜¯åç»§
                return pop;
            }
            if (pop.val == p.val) { // targetæ‰¾åˆ°åï¼Œæ‰“æ ‡
                isTargetFound = true;
            }
            if (pop.right != null) {
                cur = pop.right;
            }
        }
    }

    return null;
}
```

### æœç´¢æ ‘

```bash
# åä»»
- å…ˆæ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹
- ç›®æ ‡èŠ‚ç‚¹æœ‰å³å­æ ‘ï¼Œ åä»»å°±æ˜¯å³å­æ ‘çš„æœ€å°å€¼ï¼š               15çš„åä»»æ˜¯18
- ç›®æ ‡èŠ‚ç‚¹æ²¡æœ‰å³å­æ ‘
                  - æœ‰å³è¾¹æ¥çš„ç¥–å…ˆï¼Œ åä»»æ˜¯æœ€è¿‘çš„ä¸€ä¸ªå³è¾¹æ¥çš„ç¥–å…ˆï¼š      6çš„åä»»æ˜¯8ï¼Œ 5çš„åä»»æ˜¯6
                  - æ²¡æœ‰å³è¾¹æ¥çš„ç¥–å…ˆï¼Œ åˆ™åä»»æ˜¯null       
```

```java
public TreeNode inorderSuccessor(TreeNode root, TreeNode p) {
    TreeNode rightAncestor = null;
    TreeNode cur = root;

    while (cur != null) {
        if (cur.val < p.val) {
            cur = cur.right;
        } else if (cur.val > p.val) {
            rightAncestor = cur;
            cur = cur.left;
        } else {
            break;
        }
    }

    if (cur.right != null) {
        // æ‰¾å³å­æ ‘çš„æœ€å°å€¼
        TreeNode node = cur.right;
        while (node.left != null) {
            node = node.left;
        }
        return node;
    } else {
        return rightAncestor;
    }
}
```

## 6.  åˆ é™¤

### 5.1 å·¦èŠ‚ç‚¹æˆ–å³èŠ‚ç‚¹ä¸ºç©º

```bash
# 1. åˆ é™¤èŠ‚ç‚¹æ²¡æœ‰leftï¼Œå°†rightç»™parent                           èŠ‚ç‚¹9
# 2. åˆ é™¤èŠ‚ç‚¹æ²¡æœ‰rightï¼Œå°†leftç»™parent                           èŠ‚ç‚¹6
# 3. åˆ é™¤èŠ‚ç‚¹æ²¡æœ‰left å’Œ rightï¼Œç›´æ¥å°†nullç»™parent                èŠ‚ç‚¹1ï¼Œ åŒ…å«åœ¨1ï¼Œ2ä¸¤ç§æƒ…å†µé‡Œé¢
```

![image-20231106110112165](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231106110112165.png)

![image-20231106110326081](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231106110326081.png)

### 5.2 å·¦å³èŠ‚ç‚¹å‡ä¸ä¸ºç©º

```java
    public void delete(int val) {
        BSTreeNode target = root;
        if (target == null) {
            return;
        }
        BSTreeNode parent = null;
        // 1. æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹
        while (target != null) {
            if (target.val == val) {
                break;
            } else if (target.val < val) {
                parent = target;
                target = target.right;
            } else {
                parent = target;
                target = target.left;
            }
        }

        if (target == null) {
            return;
        }

        // 2.å¯¹å¾…åˆ é™¤èŠ‚ç‚¹è¿›è¡Œå‡ ç§æƒ…å†µçš„åˆ¤æ–­
        if (target.left == null && target.right != null) { // å¯¹å³èŠ‚ç‚¹ç›´æ¥ç»™parentä½œä¸ºå³
            shift(parent, target, target.right);
        } else if (target.left != null && target.right == null) {// å¯¹å·¦èŠ‚ç‚¹ç›´æ¥ç»™parentä½œä¸ºå·¦
            shift(parent, target, target.left);
        } else { // å·¦å³èŠ‚ç‚¹å‡ä¸æ˜¯null
            // å¾…å¤„ç†
        }
    }

    /*æ‰˜å­¤æ–¹æ³•*/
    private void shift(BSTreeNode parent, BSTreeNode deleted, BSTreeNode child) {
        if (parent == null) {
            root = child;
        } else if (deleted == parent.left) {
            parent.left = child;
        } else {
            parent.right = child;
        }
    }
```

# LeetCode

## ğŸ˜¡[235. æœ€è¿‘å…¬å…±ç¥–å…ˆ](https://leetcode.cn/problems/lowest-common-ancestor-of-a-binary-search-tree/)

```bash
# æ€è·¯
- å¦‚æœä¸¤ä¸ªå¾…æŸ¥æ‰¾èŠ‚ç‚¹ï¼Œåœ¨ä¸€ä¸ªèŠ‚ç‚¹çš„å·¦å³ä¸¤ä¾§ï¼Œåˆ™è¯¥èŠ‚ç‚¹å°±æ˜¯å®ƒä»¬çš„å…¬å…±ç¥–å…ˆ

# 10     18
- åœ¨ 15 çš„å·¦å³ä¸¤ä¾§ï¼Œåˆ™ 15 å°±æ˜¯, ä¸”åªä¼šæœ‰ä¸€ä¸ªå…¬å…±ç¥–å…ˆ

# 15     18 
- ä¸åœ¨ 8 çš„å·¦å³ä¸¤ä¾§ï¼Œåˆ™ç»§ç»­æ‰¾ 8 çš„å·¦æˆ–å³å­©å­(åˆ¤æ–­), æ‰¾åˆ° 15
```

![image-20231225154313795](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231225154313795.png)

### è¿­ä»£

```java
public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {
    TreeNode ancestor = root;
    while ((ancestor.val > p.val && ancestor.val > q.val) ||
            (ancestor.val < p.val && ancestor.val < q.val)) { // åœ¨åŒä¾§

        if (ancestor.val > p.val) {
            ancestor = ancestor.left;
        } else {
            ancestor = ancestor.right;
        }
    }

    return ancestor;
}
```

### é€’å½’

```java
public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {

    if (p.val < root.val && q.val < root.val) {
        return lowestCommonAncestor(root.left, p, q);
    }

    if (root.val < p.val && root.val < q.val) {
        return lowestCommonAncestor(root.right, p, q);
    }

    return root;
}
```

## ğŸ˜¡[98. éªŒè¯äºŒå‰æœç´¢æ ‘](https://leetcode.cn/problems/validate-binary-search-tree/)

### é€’å½’ + å·¦å³åˆæ³•

- å½“å‰ç»“ç‚¹ï¼Œå¿…é¡»æ¯”å·¦å­æ ‘ä¸­æœ€å¤§çš„å¤§ï¼Œæ¯”å¦‚æ¯”å³å­æ ‘æœ€å°çš„å°

```java
public boolean isValidBST(TreeNode root) {
    if (root == null) {
        return true;
    }

    boolean leftResult = false;
    if (root.left == null) {
        leftResult = true;
    } else {
        TreeNode max = root.left;
        while (max.right != null) {
            max = max.right;
        }
        leftResult = root.val > max.val;
    }

    boolean rightResult = false;
    if (root.right == null) {
        rightResult = true;
    } else {
        TreeNode min = root.right;
        while (min.left != null) {
            min = min.left;
        }
        rightResult = root.val < min.val;
    }

    return leftResult && rightResult && isValidBST(root.left) && isValidBST(root.right);
}
```

### é€’å½’ + å·¦å³åˆæ³•è¾¹ç•Œ

```java

```



### é€’å½’ + ä¸­åº

- ä¸­åºéå†åçš„ç»“æœï¼Œå°±åº”è¯¥æ˜¯ä¸€ä¸ªæœ‰åºé€’å¢çš„é›†åˆï¼Œå¦‚æœä¸‹ä¸€ä¸ªæ•°æ®æ¯”ä¸Šä¸€ä¸ªæ•°æ®å°äº†ï¼Œåˆ™åˆ¤æ–­ä¸åˆæ³•

```java

```



### è¿­ä»£ + ä¸­åº

- ä¸­åºéå†åçš„ç»“æœï¼Œå°±åº”è¯¥æ˜¯ä¸€ä¸ªæœ‰åºé€’å¢çš„é›†åˆï¼Œå¦‚æœä¸‹ä¸€ä¸ªæ•°æ®æ¯”ä¸Šä¸€ä¸ªæ•°æ®å°äº†ï¼Œåˆ™åˆ¤æ–­ä¸åˆæ³•

```java
public boolean isValidBST(TreeNode root) {
    LinkedList<TreeNode> paths = new LinkedList<>();

    TreeNode cur = root;
    TreeNode lastPop = null;

    while (cur != null || !paths.isEmpty()) {
        if (cur != null) {
            paths.push(cur);
            cur = cur.left;
        } else {
            TreeNode pop = paths.pop();
            if (lastPop != null && lastPop.val >= pop.val) {
                return false;
            }
            lastPop = pop;
            if (pop.right != null) {
                cur = pop.right;
            }
        }
    }

    return true;
}
```

## ğŸ˜[938. èŒƒå›´å’Œ](https://leetcode.cn/problems/range-sum-of-bst/)

- ç»™å®šäºŒå‰æœç´¢æ ‘çš„æ ¹ç»“ç‚¹rootï¼Œè¿”å›å€¼ä½äºèŒƒå›´ [low, high] ä¹‹é—´çš„æ‰€æœ‰ç»“ç‚¹çš„å€¼çš„å’Œ

### è¿­ä»£ + ä¸­åº

- åˆ©ç”¨ä¸­åºéå†åŠäºŒå‰æœç´¢æ ‘çš„ç‰¹æ€§
- åªèƒ½ä»æœ€å°çš„å¼€å§‹ï¼Œç„¶ååˆ°highçš„æ—¶å€™ç»“æŸï¼Œä¸èƒ½ç›´æ¥è¿‡æ»¤ç‚¹å°äºlowçš„èŠ‚ç‚¹çš„è¿‡æ»¤

```java
public int rangeSumBST(TreeNode root, int low, int high) {
    LinkedList<TreeNode> path = new LinkedList<>();

    int result = 0;
    TreeNode cur = root;
    while (cur != null || !path.isEmpty()) {
        if (cur != null) {
            path.push(cur);
            cur = cur.left;
        } else {
            TreeNode pop = path.pop();
            if (pop.val > high) { // åˆ°é«˜ç‚¹äº†ï¼Œç›´æ¥è¿”å›
                return result;
            }

            if (pop.val >= low) {
                result += pop.val;
            }

            if (pop.right != null) {
                cur = pop.right;
            }
        }
    }
    return result;
}
```

### é€’å½’ + å‰ªæ

```java
public int rangeSumBST(TreeNode root, int low, int high) {

    if (root == null) {
        return 0;
    }

    /*æœ¬è½®å¤„ç†çš„é€»è¾‘*/
    if (root.val < low) {
        return rangeSumBST(root.right, low, high);
    }

    if (root.val > high) {
        return rangeSumBST(root.left, low, high);
    }

    int result = root.val + rangeSumBST(root.left, low, high) + rangeSumBST(root.right, low, high);
    return result;
}
```

## ğŸ˜[653. ä¸¤æ•°ä¹‹å’Œ IV - è¾“å…¥äºŒå‰æœç´¢æ ‘](https://leetcode.cn/problems/two-sum-iv-input-is-a-bst/)

- äºŒå‰æœç´¢æ ‘çš„ä¸¤æ•°ä¹‹å’Œ

### ä¸­åº + Hash

- ä¸­åºéå†è½¬æ¢ä¸ºæ’åºæ•°ç»„ï¼Œhashå¯¹æ•°ç»„å¤„ç†

```java
public boolean findTarget(TreeNode root, int k) {
    LinkedList<TreeNode> paths = new LinkedList<>();
    TreeNode cur = root;
    ArrayList<Integer> result = new ArrayList<>();

    while (cur != null || !paths.isEmpty()) {
        if (cur != null) {
            paths.push(cur);
            cur = cur.left;
        } else {
            TreeNode pop = paths.pop();
            result.add(pop.val);
            if (pop.right != null) {
                cur = pop.right;
            }
        }
    }

    Set<Integer> hash = new HashSet<>();
    for (Integer el : result) {
        if (!hash.add(k - el)) {
            return true;
        }
        hash.add(el);
    }
    return false;
}
```
