# æ ˆ

- åªèƒ½ä»æ•°æ®ç»“æ„çš„ä¸€ç«¯è¿›è¡Œæ“ä½œï¼Œå…ˆè¿›åå‡º

![image-20231016113311031](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231016113311031.png)

```java
package com.citi.stack;

public interface MyStack {
    boolean push(int val);

    int pop();

    int peek();

    boolean isEmpty();

    boolean isFull();
}
```

## 1. é“¾è¡¨å®ç°

- å•å‘å¸¦å“¨å…µé“¾è¡¨ï¼Œå¤´æ’å¤´å‡º

![image-20231016115640568](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231016115640568.png)

```java
package com.citi.stack;

import java.util.NoSuchElementException;

public class LinkedListStack implements MyStack {
    class Node {
        int val;
        Node next;

        public Node(int val, Node next) {
            this.val = val;
            this.next = next;
        }
    }

    Node sentinel = new Node(-999, null);
    int size;
    int capacity;

    public LinkedListStack(int capacity) {
        this.capacity = capacity;
    }

    @Override
    public boolean push(int val) {
        if (isFull()) {
            return false;
        }
        sentinel.next = new Node(val, sentinel.next);
        size++;
        return true;
    }

    @Override
    public int pop() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        Node removed = sentinel.next;
        sentinel.next = removed.next;
        size--;
        return removed.val;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return sentinel.next.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == capacity;
    }
}
```

## 2. æ•°ç»„å®ç°

![image-20231202101646696](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202101646696.png)

```java
package com.citi.stack;

import java.util.NoSuchElementException;

public class ArrayStack implements MyStack {
    int[] arr;

    int top = 0;

    public ArrayStack(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean push(int val) {
        if (isFull()) {
            return false;
        }
        arr[top] = val;
        top++;
        return true;
    }

    @Override
    public int pop() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        int result = arr[top - 1];
        arr[top - 1] = -999;
        top--;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Stack");
        }
        return arr[top - 1];
    }

    @Override
    public boolean isEmpty() {
        return top == 0;
    }

    @Override
    public boolean isFull() {
        return top == arr.length;
    }
}
```

## 3. æ ˆ-é˜Ÿåˆ—è½¬æ¢

### ğŸ˜[232. ç”¨æ ˆå®ç°é˜Ÿåˆ—](https://leetcode.cn/problems/implement-queue-using-stacks/)

- å‡ºçš„æ—¶å€™ï¼Œå…ˆæŠŠå½“å‰çš„outStackä¸­å‡ºå®Œï¼Œå†å»å€’æ‰‹

![image-20231018120502207](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231018120502207.png)

```java
import java.util.LinkedList;
import java.util.NoSuchElementException;

class MyQueue {

    LinkedList<Integer> inStack = new LinkedList<>();
    LinkedList<Integer> outStack = new LinkedList<>();

    int size = 0;


    public MyQueue() {
    }

    public void push(int x) {
        inStack.push(x);
        size++;
    }

    public int pop() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }

        if (outStack.isEmpty()) {
            while (!inStack.isEmpty()) {
                outStack.push(inStack.pop());
            }
        }
        size--;
        return outStack.pop();
    }

    public int peek() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }

        if (outStack.isEmpty()) {
            while (!inStack.isEmpty()) {
                outStack.push(inStack.pop());
            }
        }
        return outStack.peek();
    }

    public boolean empty() {
        return size == 0;
    }
}
```

### ğŸ˜[225. ç”¨é˜Ÿåˆ—å®ç°æ ˆ](https://leetcode.cn/problems/implement-stack-using-queues/)

![image-20231202135602075](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202135602075.png)

```java
import java.util.LinkedList;
import java.util.NoSuchElementException;

class MyStack {

    LinkedList<Integer> queue = new LinkedList<>();

    public MyStack() {
    }

    public void push(int x) {
        queue.push(x);
        for (int i = 0; i < queue.size() - 1; i++) {
            queue.push(queue.pop());
        }
    }

    public int pop() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return queue.pop();
    }

    public int top() {
        if (empty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return queue.peek();
    }

    public boolean empty() {
        return queue.isEmpty();
    }
}
```

## ğŸ˜ [20. æœ‰æ•ˆçš„æ‹¬å·](https://leetcode.cn/problems/valid-parentheses/)

### æ ˆ

- éå†å­—ç¬¦ä¸²ï¼Œå¦‚æœå·¦è¾¹ç¬¦å·ï¼Œåˆ™å…¥æ ˆå¦ä¸€åŠå­—ç¬¦ï¼›
- å¦‚æœå³è¾¹ï¼Œåˆ™å‡ºæ ˆå¹¶æ¯”è¾ƒ

```java
public boolean isValid(String s) {
    LinkedList<Character> stack = new LinkedList<>();
    char[] chs = s.toCharArray();

    if (chs.length % 2 != 0) {
        return false;
    }
    for (char ch : chs) {
        if (ch == '{') {
            stack.push('}');
        } else if (ch == '[') {
            stack.push(']');
        } else if (ch == '(') {
            stack.push(')');
        } else {
            if (stack.isEmpty()) {
                return false;
            }
            if (stack.pop()!=ch){
                return false;
            }
        }
    }
    return stack.isEmpty();
}
```

## é€†æ³¢å…°è¡¨è¾¾å¼

### ğŸ˜¡[150. é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼](https://leetcode.cn/problems/evaluate-reverse-polish-notation/)

- <font color=orange>åç¼€è¡¨è¾¾å¼</font>ï¼šè¿ç®—ç¬¦å·åœ¨æ•°å­—çš„åé¢ï¼Œè¿™æ ·å°±ä¸ç”¨è€ƒè™‘ä¼˜å…ˆçº§é—®é¢˜
- JVMçš„è¿ç®—æŒ‡ä»¤å°±æ˜¯è¿™ä¹ˆç©çš„

#### æ ˆ

- ç¢°è§ç¬¦å·å°±æŠŠå‰é¢ä¸¤ä¸ªæ•°å­—å¼¹å‡ºæ ˆ
- è¿ç®—å®Œæˆåé‡æ–°å…¥æ ˆ

```java
public int evalRPN(String[] tokens) {
      LinkedList<Integer> stack = new LinkedList<>();
      for (String token : tokens) {
          // å¤„ç†å…·ä½“é€»è¾‘
          Integer second;
          Integer first;
          switch (token) {
              case "+":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first + second);
                  break;
              case "-":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first - second);
                  break;
              case "*":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first * second);
                  break;
              case "/":
                  second = stack.pop();
                  first = stack.pop();
                  stack.push(first / second);
                  break;
              default:
                  stack.push(Integer.valueOf((token)));
          }
      }
      return stack.pop();
  }
```

### ğŸ˜¡ä¸­ç¼€è½¬åç¼€-æ— æ‹¬å·

- ç»™ä¸€ä¸ªä¸­ç¼€è¡¨è¾¾å¼ï¼Œå°†å…¶è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼

![image-20231202132427456](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231202132427456.png)

```java
/*ä¸­ç¼€è¡¨è¾¾å¼è½¬åç¼€*/
public String convert(String str) {
    LinkedList<Character> stack = new LinkedList<>();
    StringBuffer sb = new StringBuffer();
    char[] chs = str.toCharArray();

    for (char ch : chs) {
        if (priority(ch) == -1) {  // 1. ä¸æ˜¯è¿ç®—ç¬¦ï¼Œåˆ™ç›´æ¥æ‹¼æ¥
            sb.append(ch);
        } else {                   // 2. æ˜¯è¿ç®—ç¬¦
            if (stack.isEmpty()) {
                stack.push(ch);           // 2.1 æ ˆå¦‚æœä¸ºç©ºï¼Œåˆ™ç›´æ¥æ·»åŠ 
            } else {                      // 2.2 æ ˆä¸ç©ºï¼Œåˆ¤æ–­
                if (priority(ch) <= priority(stack.peek())) {
                    while (!stack.isEmpty() && stack.peek() >= priority(ch)) {
                        sb.append(stack.pop());
                    }
                }
                stack.push(ch);
            }
        }
    }
    //3. å¤„ç†å®Œæˆåï¼ŒæŠŠæ ˆé‡Œçš„å…ƒç´ ä¾æ¬¡å‡ºæ ˆæ‹¼æ¥
    while (!stack.isEmpty()) {
        sb.append(stack.pop());
    }
    return sb.toString();
}

private int priority(char ch) {
    switch (ch) {
        case '+':
        case '-':
            return 0;
        case '*':
        case '/':
            return 1;
        default:
            return -1;
    }
}
```

# é˜Ÿåˆ—

## 1. æ™®é€šé˜Ÿåˆ—

- å°¾è¿›æ•°æ®ï¼Œå¤´å‡ºæ•°æ®
- 622é¢˜ç›®

```java
package com.citi.queue;

interface MyQueue {

    /*å°¾æ’*/
    boolean offer(int val);

    /*å¤´å¼¹ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›null*/
    int poll();

    /*è·å–å¤´å…ƒç´ ï¼Œä¸å¼¹å‡ºæ¥ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œè¿”å›null*/
    int peek();

    boolean isEmpty();

    boolean isFull();
}
```

### é“¾è¡¨å®ç°

- å¯ä»¥ä½¿ç”¨å•å‘ç¯å½¢å¸¦å“¨å…µçš„é“¾è¡¨æ¥å®ç°é˜Ÿåˆ—

![image-20231129130253403](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231129130253403.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class LinkedListQueue implements MyQueue {

    class Node {
        int val;
        Node next;

        public Node(int val) {
            this.val = val;
        }

        public Node(int val, Node next) {
            this.val = val;
            this.next = next;
        }
    }

    Node sentinel = new Node(-999);
    Node head; // headä¸ä¼šç§»åŠ¨
    Node tail; // tailç§»åŠ¨
    int size = 0;
    int capacity;

    public LinkedListQueue(int capacity) {
        this.capacity = capacity;
        sentinel.next = sentinel;
        head = sentinel;
        tail = sentinel;
    }

    /*å°¾æ’*/
    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        inserted.next = sentinel;
        tail.next = inserted;
        tail = tail.next;
        size++;
        return true;
    }

    /*åˆ é™¤sentinelåé¢çš„ç¬¬ä¸€ä¸ªå…ƒç´ : è¦è€ƒè™‘åªå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æƒ…å†µ*/
    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.next;
        sentinel.next = sentinel.next.next;
        size--;
        // æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œè€ƒè™‘ä¸‹
        if (isEmpty()) {
            tail = sentinel;
        }
        return removed.val;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.next.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        if (size == capacity) {
            return true;
        }
        return false;
    }
}
```

### ç¯å½¢æ•°ç»„

- ç›¸æ¯”æ™®é€šæ•°ç»„ï¼Œèµ·ç‚¹å’Œç»ˆç‚¹æ›´åŠ è‡ªç”±ï¼Œä¸ç”¨è€ƒè™‘æ•°æ®ç§»åŠ¨
- ç¯å½¢æ•°ç»„ï¼Œå°±æ˜¯åœ¨æ•°ç»„é•¿åº¦å›ºå®šçš„æƒ…å†µä¸‹ï¼Œå®šä¹‰ä¸€å®šçš„å¯ç”¨ç´¢å¼•èŒƒå›´ï¼Œé€šè¿‡è¦†ç›–å†™æ¥è¿›è¡Œ
- æ•°ç»„æ€§èƒ½æ›´ä½³
- å¯ä»¥ç”¨ä¸‰ç§ä¸åŒçš„å®ç°æ¥åš
- ä¸‹ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼šhead = (head +1)%arr.lengthï¼Œæ¯æ¬¡è®¡ç®—ç´¢å¼•ï¼Œéƒ½å¿…é¡»é€šè¿‡è¿™ä¸ªå…¬å¼ï¼Œè€Œä¸èƒ½ä½¿ç”¨++æˆ–è€…--

#### ç©ºä½ç½®

- ç©ºä½ç½®æ˜¯ç§»åŠ¨çš„ï¼Œæ˜¯headåé¢çš„ä¸€ä¸ªå…ƒç´ 
- æµªè´¹äº†ä¸€ä¸ªç´¢å¼•ä½ç½®æ¥è¿›è¡Œåˆ¤æ»¡
- ä¸Šä¸€ä¸ªå…ƒç´ ä½ç½® tail = (tail+(arr.length-1))%arr.length, ç”¨æ¥è·å–å°¾éƒ¨å…ƒç´ ï¼Œé˜²æ­¢æ•°ç»„è¶Šç•Œ

![image-20231205211525773](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231205211525773.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayFirstQueue implements MyQueue {

    int[] arr;

    int head = 0;

    int tail = 0;

    public ArrayFirstQueue(int capacity) {
        this.arr = new int[capacity + 1]; // ç©ºä½ç½®è¦ä¿å­˜æ•°æ®
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length; // tailå‘åç§»åŠ¨ä¸€æ¬¡
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head];
        arr[head] = -999; // å¯ä»¥ä¸è¦†ç›–å†™
        head = (head + 1) % arr.length;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head];
    }

    @Override
    public boolean isEmpty() {
        return head == tail;
    }

    /*tail+1=head*/
    @Override
    public boolean isFull() {
        return head == (tail + 1) % arr.length;
    }
}
```

#### æ–°å¢size

- æ–°å¢ä¸€ä¸ªsizeå˜é‡ï¼Œæ¥åˆ¤æ–­é˜Ÿåˆ—æ˜¯ç©ºè¿˜æ˜¯æ»¡

![image-20231130103618498](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231130103618498.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArraySecondQueue implements MyQueue {
    int[] arr;

    int size;

    int head = 0;
    int tail = 0;

    public ArraySecondQueue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length;
        size++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head];
        arr[head] = -999; // å¯ä»¥ä¸è¦†ç›–å†™
        head = (head + 1) % arr.length;
        size--;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }
}
```

#### head/tailè‡ªå¢

- headå’Œtailä¸æ–­è‡ªå¢ï¼Œè‡ªå¢åˆ°æ­£æ— ç©·
- å…·ä½“è®¡ç®—ä¸‹ä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†å»è¿›è¡Œè¿ç®—
- æ²¡æœ‰sizeå±æ€§

##### æ¨¡è¿ç®—

![image-20231014110521963](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231014110521963.png)

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayThirdQueue implements MyQueue {
    int[] arr;
    int head = 0;
    int tail = 0;

    public ArrayThirdQueue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[(tail) % arr.length] = val;
        tail++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head % arr.length];
        arr[head % arr.length] = -999; // å¯ä»¥ä¸è¦†ç›–
        head++;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head % arr.length];
    }

    @Override
    public boolean isEmpty() {
        return tail == head;
    }

    @Override
    public boolean isFull() {
        return tail - head == arr.length;
    }
}
```

##### ä½è¿ç®—

- å‡å¦‚æ•°ç»„çš„headå’Œtailä¸€ç›´å¢åŠ ï¼Œé‚£ä¹ˆå½“è¶…è¿‡intçš„æœ€å¤§å€¼çš„æ—¶å€™ï¼Œè®¡ç®—å‡ºæ¥çš„ç´¢å¼•å°±æ˜¯è´Ÿï¼Œå°±ä¼šæŠ¥é”™
- å½“æ•°ç»„é•¿åº¦æ˜¯2çš„næ¬¡æ–¹çš„æ—¶å€™ï¼Œè®¡ç®—ç´¢å¼•çš„æ—¶å€™ï¼Œæ±‚æ¨¡è¿ç®—å¯ä»¥ç”¨ä½è¿ç®—æ¥ä»£æ›¿

```bash
# æ±‚æ¨¡è¿ç®— vs æŒ‰ä½ä¸
# å‰æï¼šé™¤æ•°æ˜¯ 2 çš„  n  æ¬¡æ–¹

# ç»“æœï¼š head&(arr.length-1)
```

```java
package com.citi.queue;

import java.util.NoSuchElementException;

public class ArrayFourthQueue implements MyQueue{
    int[] arr;
    int head = 0;
    int tail = 0;

    public ArrayFourthQueue(int capacity) {
        arr = new int[capacity];
    }

    /*è¯¥ç”¨ä½è¿ç®—
    1. å¯ä»¥è§£å†³ç´¢å¼•è¶…è¿‡intèŒƒå›´é—®é¢˜
    2. ä½è¿ç®—æ›´å¿«*/
    @Override
    public boolean offer(int val) {
        if (isFull()) {
            return false;
        }
        arr[(tail) & (arr.length - 1)] = val;
        tail++;
        return true;
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int result = arr[head & (arr.length - 1)];
        arr[head & (arr.length - 1)] = -999; // å¯ä»¥ä¸è¦†ç›–
        head++;
        return result;
    }

    @Override
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return arr[head & (arr.length - 1)];
    }

    @Override
    public boolean isEmpty() {
        return tail == head;
    }

    /*ä¸ç”¨æ‹…å¿ƒè¶Šç•Œé—®é¢˜*/
    @Override
    public boolean isFull() {
        return tail - head == arr.length;
    }
}
```

## 2. åŒç«¯é˜Ÿåˆ—

- ä¸¤ç«¯éƒ½å¯ä»¥è¿›è¡Œåˆ é™¤ï¼Œæ·»åŠ 
- Deque: Double Ended Queue
- 641é¢˜ç›®

```java
package com.citi.deque;

interface MyDequeue {
    boolean offerFirst(int val);

    boolean offerLast(int val);

    int pollFirst();

    int pollLast();

    int peekFirst();

    int peekLast();

    boolean isEmpty();

    boolean isFull();
}
```

### é“¾è¡¨å®ç°

- åŒå‘ç¯å½¢é“¾è¡¨ï¼Œå¸¦å¤´æŒ‡é’ˆ

![image-20231203111932930](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231203111932930.png)

```java
import java.util.NoSuchElementException;

public class LinkedDequeue implements MyDequeue {

    Node sentinel = new Node(-999);

    int size;
    int capacity;


    public LinkedDequeue(int capacity) {
        this.capacity = capacity;
        sentinel.next = sentinel;
        sentinel.prev = sentinel;
    }


    @Override
    public boolean offerFirst(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        size++;
        // æ’å…¥ç»“ç‚¹ï¼šç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        inserted.prev = sentinel;
        inserted.next = sentinel.next;
        // ç»´æŠ¤å‰å
        sentinel.next.prev = inserted;
        sentinel.next = inserted;
        return true;
    }

    @Override
    public boolean offerLast(int val) {
        if (isFull()) {
            return false;
        }
        Node inserted = new Node(val);
        size++;
        // æ’å…¥ç»“ç‚¹ï¼šç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        inserted.prev = sentinel.prev;
        inserted.next = sentinel;
        // ç»´æŠ¤å‰å
        sentinel.prev.next = inserted;
        sentinel.prev = inserted;
        return true;
    }

    @Override
    public int pollFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.next;
        // åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        sentinel.next = sentinel.next.next;
        sentinel.next.prev = sentinel;
        size--;
        return removed.val;
    }

    @Override
    public int pollLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        Node removed = sentinel.prev;
        // åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ
        sentinel.prev.prev.next = sentinel;
        sentinel.prev = sentinel.prev.prev;
        size--;
        return removed.val;
    }

    @Override
    public int peekFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.next.val;
    }

    @Override
    public int peekLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        return sentinel.prev.val;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == capacity;
    }
}
```

```java
class Node {
    int val;
    Node prev;
    Node next;

    public Node(int val) {
        this.val = val;
    }

    public Node(Node prev, int val, Node next) {
        this.prev = prev;
        this.val = val;
        this.next = next;
    }
}
```

### ç¯å½¢æ•°ç»„

#### ç©ºä½ç½®

#### æ–°å¢size

![image-20231205225124108](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231205225124108.png)

```java
package com.citi.deque;

import java.util.NoSuchElementException;

public class SecondArrayDequeue implements MyDequeue {

    int[] arr;

    int size;

    int head;

    int tail;

    public SecondArrayDequeue(int capacity) {
        arr = new int[capacity];
    }

    @Override
    public boolean offerFirst(int val) {
        if (isFull()) {
            return false;
        }
        // ç´¢å¼•å‡ä¸€çš„å¤„ç†
        head = (head + arr.length - 1) % arr.length;
        arr[head] = val;
        size++;
        return true;
    }

    @Override
    public boolean offerLast(int val) {
        if (isFull()) {
            return false;
        }
        arr[tail] = val;
        tail = (tail + 1) % arr.length;
        size++;
        return true;
    }

    @Override
    public int pollFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        int result = arr[head];
        arr[head] = -999;
        head = (head + 1) % arr.length;
        size--;
        return result;
    }

    @Override
    public int pollLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }

        tail = (tail + arr.length - 1) % arr.length; // å‡1
        int result = arr[tail];
        arr[tail] = -999;
        size--;
        return result;
    }

    @Override
    public int peekFirst() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        return arr[(head % arr.length)];
    }

    @Override
    public int peekLast() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Dequeue");
        }
        return arr[(tail + arr.length - 1) % arr.length];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }
}
```

#### head/tailè‡ªå¢

- headå’Œtailä¸æ–­è‡ªå¢ï¼Œè‡ªå¢åˆ°æ­£æ— ç©·
- å…·ä½“è®¡ç®—ä¸‹ä¸€ä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†å»è¿›è¡Œè¿ç®—
- æ²¡æœ‰sizeå±æ€§

## 3. ä¼˜å…ˆçº§é˜Ÿåˆ—

- æ•°ç»„çš„å¯¹è±¡å¤šäº†ä¸€ä¸ªä¼˜å…ˆçº§çš„å±æ€§
- å…¥é˜Ÿæ˜¯å°¾éƒ¨æ’å…¥
- å‡ºé˜Ÿæ—¶ï¼Œä¼˜å…ˆçº§é«˜çš„å…ˆå‡ºæ¥

```java
public interface PriorityQueue {
    boolean offer(Entry entry);

    Entry poll();

    Entry peek();

    boolean isEmpty();

    boolean isFull();
}
```

```java
class Entry {
    int value;
    int priority;

    public Entry(int value, int priority) {
        this.value = value;
        this.priority = priority;
    }
}
```

### æ— åºæ•°ç»„--size

![image-20231206131751397](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231206131751397.png)

```java
package com.citi.priorityqueue;

import java.util.NoSuchElementException;

public class ArrayPriorityQueue implements PriorityQueue {

    Entry[] arr;
    int size;

    @Override
    public boolean offer(Entry entry) {
        if (isFull()) {
            return false;
        }
        arr[size] = entry;
        size++;
        return false;
    }

    @Override
    public Entry poll() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int targetIndex = selectMaxPriorityIndex();
        Entry removedEntry = arr[targetIndex];
        remove(targetIndex);
        return removedEntry;
    }

    @Override
    public Entry peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Empty Queue");
        }
        int targetIndex = selectMaxPriorityIndex();
        return arr[targetIndex];
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    @Override
    public boolean isFull() {
        return size == arr.length;
    }

    /*å¯»æ‰¾ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ */
    private int selectMaxPriorityIndex() {
        int maxIndex = -1;
        int priority = Integer.MIN_VALUE;
        for (int i = 0; i < size; i++) {
            Entry entry = arr[i];
            if (entry.priority > priority) {
                maxIndex = i;
            }
        }
        return maxIndex;
    }

    /*åˆ é™¤å…ƒç´ */
    private void remove(int index) {
        if (index == size - 1) { // é˜Ÿåˆ—æœ€åä¸€ä¸ªå…ƒç´ 
            arr[index] = null;
        } else { // å¤åˆ¶æ‹·è´
            System.arraycopy(arr, index + 1, arr, index, size - 1 + index);
            arr[size - 1] = null;
        }
        size--;
    }
}
```

### æœ‰åºæ•°ç»„å®ç°

- æ’å…¥æ—¶å€™è¿›è¡Œæ’å…¥æ’åºï¼Œå¼¹å‡ºæ—¶ï¼Œåªéœ€è¦å¼¹å‡ºæ•°å°¾éƒ¨çš„å…ƒç´ 

![image-20231022103506620](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231022103506620.png)

```java
class SortedArrayPriorityQueue {
    private Entry[] arr;

    private int capacity;
    private int size;

    public SortedArrayPriorityQueue(int capacity) {
        this.capacity = capacity;
        arr = new Entry[capacity];
    }

    public boolean offer(Entry entry) {
        if (isFull()) {
            return false;
        }
        insert(entry);
        return true;
    }

    /*æ’å…¥æ’åº*/
    private void insert(Entry entry) {
        int p = size - 1;
        while (p > 0 && arr[p].priority > entry.priority) {
            arr[p + 1] = arr[p];
            p--;
        }
        arr[p + 1] = entry;
    }


    public Entry poll() {
        if (isEmpty()) {
            return null;
        }
        Entry entry = arr[size - 1];
        arr[size - 1] = null;
        return entry;
    }

    public Entry peek() {
        if (isEmpty()) {
            return null;
        }
        return arr[size - 1];
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public boolean isFull() {
        return size == capacity;
    }
}
```

### å †å®ç°

- å †ï¼Œæœ¬èº«å°±æ˜¯ä¸€ç§ä¼˜å…ˆçº§é˜Ÿåˆ—

## 4. é˜»å¡é˜Ÿåˆ—

### å•é”å®ç°

### åŒé”å®ç°



# å †-ä¼˜å…ˆé˜Ÿåˆ—

- å †æ˜¯ä¸€ç§ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„çš„æ–¹å¼å®ç°

## 1. å¤§é¡¶å †/å°é¡¶å †

```bash
# å¤§é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹éƒ½å°äºå…¶çˆ¶èŠ‚ç‚¹
# å°é¡¶å †ï¼š ä»»æ„èŠ‚ç‚¹éƒ½å¤§ä¸å…¶çˆ¶èŠ‚ç‚¹
- å·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹å…³ç³»ä¸å®š

# ç´¢å¼•åŸåˆ™ï¼šç´¢å¼•0å¼€å§‹å­˜å‚¨ï¼Œiè¡¨ç¤ºç´¢å¼•
- èŠ‚ç‚¹içš„çˆ¶èŠ‚ç‚¹ï¼š       floor((i-1)/2)      å½“iå¤§äº0æ—¶
- èŠ‚ç‚¹içš„å·¦å­èŠ‚ç‚¹ä¸ºï¼š    2i+1                ç»“æœä¸èƒ½å¤§äºsize
- èŠ‚ç‚¹içš„å³å­èŠ‚ç‚¹ä¸ºï¼š    2i+2                ç»“æœä¸èƒ½å¤§äºsize
```

![image-20231023190718489](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231023190718489.png)

## 2. MaxHeap

```java
package com.citi.heap;

public interface MaxHeap {
    /*å¤´å°¾äº¤æ¢ï¼Œå¹¶ä¸‹æ½œ*/
    int poll();

    void down(int parent);

    /*å°¾éƒ¨æ·»åŠ ï¼šå¹¶ä¸Šæµ®*/
    boolean offer(int data);

    void up(int child);

    boolean isFull();

    boolean isEmpty();
}
```

### 2.1 offer

```bash
# å¨å»‰å§†æ–¯ç®—æ³•
- å…¥å †æ–°å…ƒç´ ï¼ŒåŠ å…¥åˆ°æ•°ç»„æœ«å°¾
- ä¸æ–­æ¯”è¾ƒæ–°åŠ å…ƒç´ ä¸å…¶çˆ¶èŠ‚ç‚¹çš„å€¼
    - çˆ¶èŠ‚ç‚¹æ›´å°ï¼Œåˆ™çˆ¶èŠ‚ç‚¹å‘ä¸‹ç§»åŠ¨ï¼Œç»§ç»­å‘ä¸Šæ‰¾parent
    - ç›´åˆ°çˆ¶èŠ‚ç‚¹å€¼æ›´å¤§
```

![image-20231023172249031](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231023172249031.png)

### 2.2 poll

```bash
# pollï¼š åˆ é™¤å †é¡¶å¤„çš„å…ƒç´ 
- å †é¡¶å…ƒç´  å’Œæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢
- åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ 
- å¯¹å †é¡¶å…ƒç´ è¿›è¡Œä¸‹æ½œ

# ä¸‹æ½œï¼š æ¯”å·¦å³å­©å­æœ€å¤§çš„å°
- æ¯”è¾ƒå½“å‰èŠ‚ç‚¹çš„å€¼å’Œå·¦å³å­©å­çš„å€¼
- å¦‚æœå½“å‰èŠ‚ç‚¹çš„å€¼æ¯”å·¦å³å­©å­æœ€å¤§çš„å°ï¼Œåˆ™äº¤æ¢
```

### 2.3 heapify

```bash
# æ–¹å¼ä¸€ï¼šå¨å»‰å§†æ–¯ç®—æ³•ï¼Œæ—§æ•°ç»„ï¼Œä¸€ä¸ªä¸ªofferè¿›å»

# æ–¹å¼äºŒï¼šå¼—æ´›ä¼Šå¾·ç®—æ³•):  å¯¹æ—¢æœ‰æ•°ç»„è¿›è¡Œé‡æ’ï¼Œ
- æ‰¾åˆ°æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹
- ä»åå‘å‰ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œä¸‹æ½œï¼ˆæ¯”è¾ƒå·¦å³å€¼ï¼‰

    # éå¶å­èŠ‚ç‚¹
   - æ²¡æœ‰ä»»ä½•ä¸€ä¸ªå·¦å­©å­æˆ–è€…å³å­©å­
   - æœ€åä¸€ä¸ªå…ƒç´ çš„çˆ¶èŠ‚ç‚¹
```

![image-20231023152506251](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231023152506251.png)

```java
package com.citi.heap;

public class ArrayMaxHeap implements MaxHeap {

    private int[] arr;
    private int size;

    private int capacity;

    public ArrayMaxHeap(int capacity) {
        this.capacity = capacity;
        arr = new int[capacity];
    }

    /*ç°æœ‰æ•°ç»„æ„å»º:*/
    public ArrayMaxHeap(int[] input, int capacity) {
        this(capacity);
        if (input.length <= capacity) {
            size = input.length;
            System.arraycopy(arr, 0, input, 0, input.length);
            heapfiy(arr);
        } else {
            size = arr.length;
            System.arraycopy(arr, 0, input, 0, capacity);
            heapfiy(arr);
        }
    }

    private void heapfiy(int[] arr) {
        int lastIndex = size / 2 - 1;
        for (int i = lastIndex; i >= 0; i--) {
            down(i);
        }
    }

    @Override
    public int poll() {
        if (isEmpty()) {
            return Integer.MIN_VALUE;
        }
        int res = arr[0];

        swap(0, size - 1);
        arr[size - 1] = Integer.MIN_VALUE;
        down(0);
        size--;
        return res;
    }

    @Override
    public void down(int parent) {
        int left = 2 * parent + 1;
        int right = 2 * parent + 2;
        int max = parent;
        if (left < size && arr[left] > arr[max]) {
            max = left;
        }
        if (right < size && arr[right] > arr[max]) {
            max = right;
        }
        if (parent != max) {
            swap(parent, max);
            down(max);
        }
    }

    @Override
    public boolean offer(int data) {
        if (isFull()) {
            return false;
        }

        arr[size] = data;
        up(size);
        size++;
        return true;
    }

    @Override
    public void up(int child) {
        int val = arr[child];
        int parent = (child - 1) / 2;
        while (arr[parent] < val && child > 0) {
            arr[child] = arr[parent];
            child = parent;
            parent = (child - 1) / 2;
        }
        arr[child] = val;
    }

    @Override
    public boolean isFull() {
        return size == capacity;
    }

    @Override
    public boolean isEmpty() {
        return size == 0;
    }

    private void swap(int i, int j) {
        int temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
}
```

## 3. JDK-PriorityQueue

```java
PriorityQueue<Integer> max = new PriorityQueue<>((a, b) -> (b - a));      // å¤§é¡¶å †
PriorityQueue<Integer> min = new PriorityQueue<>((a, b) -> (a - b));      // å°é¡¶å †
```



## 4. LeetCode

### â¤ï¸[æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ ](https://leetcode.cn/problems/kth-largest-element-in-an-array/)

```bash
# å°é¡¶å †(å †åº•å…ƒç´ å°±æ˜¯ç¬¬kå¤§çš„)
# æ–¹æ³•ç±»ä¼¼å¤§é¡¶å †
- 1. å°†å‰kä¸ªå…ƒç´ åŠ å…¥åˆ°æ•°ç»„ä¸­ï¼Œå¹¶heapifyæˆå°é¡¶å †
- 2. åç»­æ•°ç»„å…ƒç´ ä¾æ¬¡å…¥å’Œå †é¡¶å…ƒç´ æ¯”è¾ƒ
    - 2.1 å¦‚æœæ¯”å †é¡¶å¤§ï¼Œåˆ™æ›¿æ¢å †é¡¶å…ƒç´ ï¼Œå¹¶ä¸‹æ½œ
    - 2.2 å¦‚æœæ¯”å †é¡¶å°æˆ–ç­‰ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åš
- 3. è¿”å›å †é¡¶å…ƒç´  
```

![image-20231026112424150](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231026112424150.png)

```java
// JDKæä¾›çš„å°é¡¶å †
public int findKthLargest(int[] nums, int k) {
    PriorityQueue<Integer> stack = new PriorityQueue<>(k, Comparator.comparingInt(a -> a));
    for (int i = 0; i < k; i++) {
        stack.add(nums[i]);
    }

    for (int i = k; i < nums.length; i++) {
        if (nums[i] > stack.peek()) {
            stack.poll();
            stack.add(nums[i]);
        }
    }
    return stack.peek();
}
```

### 4.2 æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´  - 321

```bash
# ç»™å®šæ•´æ•°æ•°ç»„ nums å’Œæ•´æ•° kï¼Œè¿”å›æ•°ç»„ä¸­ç¬¬kä¸ªæœ€å¤§çš„å…ƒç´ 
# å¯ä»¥ç»™æ•°ç»„ä¸æ–­æ·»åŠ æ–°çš„å…ƒç´ ï¼Œä¾ç„¶è¿”å›ç¬¬Kä¸ªæœ€å¤§çš„å…ƒç´ 
#  æ•°ç»„åˆå§‹å¯èƒ½ä¸ºnullï¼Œæ•°æ®å¯èƒ½ä¸ºè´Ÿæ•°
# é¢˜ç›®æ•°æ®ä¿è¯ï¼Œåœ¨æŸ¥æ‰¾ç¬¬ k å¤§å…ƒç´ æ—¶ï¼Œæ•°ç»„ä¸­è‡³å°‘æœ‰ k ä¸ªå…ƒç´ 

# è§£é¢˜æ€è·¯ç±»ä¼¼ä¸Šé¢
- 1.æ„å»ºå¤§å°ä¸ºkçš„å°é¡¶å †: æ•°æ®ä¸ºInteger.MIN_VALUE
- 2.é€ä¸ªæ·»åŠ é¡¶éƒ¨å…ƒç´ ï¼Œå¹¶è¿›è¡Œä¸‹æ½œ
```

```java
class KthLargest {

    private MinHeap minHeap;

    public KthLargest(int k, int[] nums) {
        minHeap = new MinHeap(k);
        for (int i = 0; i < nums.length; i++) {
            minHeap.add(nums[i]);
        }
    }

    public int add(int val) {
        minHeap.add(val);
        return minHeap.arr[0];
    }
}

class MinHeap {
    int[] arr;
    int size;
    int capacity;

    public MinHeap(int capacity) {
        this.capacity = capacity;
        arr = new int[capacity];
        Arrays.fill(arr, Integer.MIN_VALUE);
        size = capacity;
    }

    public void add(int data) {
        if (data > arr[0]) {
            arr[0] = data;
            down(0);
        }
    }

    private void down(int parent) {
        int left = parent * 2 + 1;
        int right = parent * 2 + 2;
        int min = parent;
        if (left < size && arr[left] < arr[min]) {
            min = left;
        }
        if (right < size && arr[right] < arr[min]) {
            min = right;
        }
        if (min != parent) {
            swap(min, parent);
            down(min);
        }
    }

    private void swap(int i, int j) {
        int temp = arr[i];
        arr[i] = arr[j];
        arr[j] = temp;
    }
}
```

### 4.3 æ•°æ®æµçš„ä¸­ä½æ•°

```bash
è¾“å…¥ï¼š 2,3,4,     è¾“å‡ºï¼š3
è¾“å…¥ï¼š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ è¾“å‡ºï¼š2.5

# æ€è·¯ï¼šæ„å»ºä¸€ä¸ªå¤§é¡¶å †ï¼Œä¸€ä¸ªå°é¡¶å †ï¼Œç¡®ä¿å¤§é¡¶å †çš„å †é¡¶å…ƒç´ å°äºå°é¡¶å †çš„å †é¡¶å…ƒç´ 
# add
- ä¸¤è¾¹ä¸ªæ•°ä¸€æ ·æ—¶ï¼Œå·¦è¾¹ä¸ªæ•°åŠ ä¸€
- ä¸¤è¾¹ä¸ªæ•°ä¸ä¸€æ ·æ—¶ï¼Œå³è¾¹åŠ ä¸€
# addè§„åˆ™
- å·¦è¾¹æ·»åŠ æ—¶ï¼ŒæŠŠæ–°å…ƒç´ æ·»åŠ åœ¨å³ï¼Œå¼¹å‡ºå³è¾¹å †é¡¶å…ƒç´ åŠ å…¥å·¦è¾¹
- å³è¾¹é€»è¾‘ç±»ä¼¼
```

![image-20231029104600488](https://erick-typora-image.oss-cn-shanghai.aliyuncs.com/img/image-20231029104600488.png)

```java
class MedianFinder {

    PriorityQueue<Integer> max = new PriorityQueue<>((a, b) -> (b - a));
    PriorityQueue<Integer> min = new PriorityQueue<>((a, b) -> (a - b));

    public MedianFinder() {
    }

    public void addNum(int num) {
        if (max.size() == min.size()) {
            // æ·»åŠ åˆ°å¤§é¡¶å †
            min.add(num); // æ·»åŠ åè¿˜æ˜¯æœ‰åºçš„å †
            Integer data = min.poll();
            max.add(data);
        } else {
            // æ·»åŠ åˆ°å°é¡¶å †
            max.add(num);
            Integer data = max.poll();
            min.add(data);
        }
    }

    public double findMedian() {
        if (max.size() == min.size()) {
            return (max.peek() + min.peek()) / 2.0;
        } else {
            return max.peek();
        }
    }
}
```



## 

# JDK-æ ˆ-é˜Ÿåˆ—(æ™®é€š,åŒç«¯)

## 1. LinkedList

- åº•å±‚æ˜¯ç”¨é“¾è¡¨å®ç°
- æ ˆï¼Œæ™®é€šé˜Ÿåˆ—ï¼ŒåŒç«¯é˜Ÿåˆ—

## 2. ArrayDeque

- åº•å±‚ç”¨æ•°ç»„å®ç°
- æ ˆï¼Œæ™®é€šé˜Ÿåˆ—ï¼ŒåŒç«¯é˜Ÿåˆ—
